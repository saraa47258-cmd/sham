<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>Ø³ÙˆØ¨Ø± Ø£Ø¯Ù…Ù† - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #8b5cf6;
            --accent: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #0f172a;
            --bg-secondary: #1e293b;
            --card-bg: #1e293b;
            --card-hover: #334155;
            --text: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
            --gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
        }
        
        body.light-mode {
            --bg: #f8fafc;
            --bg-secondary: #e2e8f0;
            --card-bg: #ffffff;
            --card-hover: #f1f5f9;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: var(--bg);
            min-height: 100vh;
            color: var(--text);
        }
        
        /* Sidebar */
        .sidebar {
            position: fixed;
            right: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: var(--card-bg);
            border-left: 1px solid var(--border);
            padding: 25px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 25px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }
        
        .logo-icon i { color: white; font-size: 1.5rem; }
        
        .logo-text h1 { font-size: 1.2rem; font-weight: 700; }
        .logo-text p { font-size: 0.8rem; color: var(--text-secondary); }
        
        .nav-menu { flex: 1; }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            border-radius: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 8px;
        }
        
        .nav-item:hover, .nav-item.active {
            background: var(--card-hover);
            color: var(--text);
        }
        
        .nav-item.active {
            background: var(--gradient);
            color: white;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.3);
        }
        
        .nav-item i { font-size: 1.1rem; width: 24px; }
        
        .sidebar-footer {
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }
        
        .admin-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: var(--bg);
            border-radius: 12px;
            margin-bottom: 15px;
        }
        
        .admin-avatar {
            width: 45px;
            height: 45px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }
        
        .admin-details h4 { font-size: 0.95rem; }
        .admin-details p { font-size: 0.8rem; color: var(--text-secondary); }
        
        .logout-btn {
            width: 100%;
            padding: 12px;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            color: var(--danger);
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .logout-btn:hover {
            background: var(--danger);
            color: white;
        }
        
        /* Main Content */
        .main-content {
            margin-right: 280px;
            padding: 30px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .header-title h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .header-title p { color: var(--text-secondary); }
        
        .header-actions {
            display: flex;
            gap: 12px;
        }
        
        .theme-btn, .add-btn {
            padding: 12px 20px;
            border-radius: 12px;
            border: none;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .theme-btn {
            background: var(--card-bg);
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .theme-btn:hover { background: var(--card-hover); }
        
        .add-btn {
            background: var(--gradient);
            color: white;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.3);
        }
        
        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            opacity: 0.1;
            transform: translate(30%, -30%);
        }
        
        .stat-card:nth-child(1)::before { background: var(--primary); }
        .stat-card:nth-child(2)::before { background: var(--accent); }
        .stat-card:nth-child(3)::before { background: var(--warning); }
        .stat-card:nth-child(4)::before { background: var(--secondary); }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .stat-icon {
            width: 55px;
            height: 55px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .stat-card:nth-child(1) .stat-icon { background: rgba(99, 102, 241, 0.15); color: var(--primary); }
        .stat-card:nth-child(2) .stat-icon { background: rgba(16, 185, 129, 0.15); color: var(--accent); }
        .stat-card:nth-child(3) .stat-icon { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
        .stat-card:nth-child(4) .stat-icon { background: rgba(139, 92, 246, 0.15); color: var(--secondary); }
        
        .stat-icon i { font-size: 1.5rem; }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 5px;
        }
        
        .stat-label { color: var(--text-secondary); font-size: 0.95rem; }
        
        /* Restaurants Section */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-header h3 i { color: var(--primary); }
        
        .filter-tabs {
            display: flex;
            gap: 10px;
        }
        
        .filter-tab {
            padding: 8px 18px;
            border-radius: 8px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-family: inherit;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-tab.active, .filter-tab:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Restaurant Cards */
        .restaurants-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
        }
        
        .restaurant-card {
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .restaurant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            border-color: var(--primary);
        }
        
        .restaurant-header {
            padding: 25px;
            background: var(--gradient);
            position: relative;
        }
        
        .restaurant-header::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 0;
            right: 0;
            height: 40px;
            background: var(--card-bg);
            border-radius: 20px 20px 0 0;
        }
        
        .restaurant-icon {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            position: relative;
            z-index: 1;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .restaurant-status {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .restaurant-status.active {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .restaurant-status.inactive {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .restaurant-body {
            padding: 15px 25px 25px;
        }
        
        .restaurant-name {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .restaurant-type {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .restaurant-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 15px;
            background: var(--bg);
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .r-stat {
            text-align: center;
        }
        
        .r-stat-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .r-stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }
        
        /* Restaurant Link Box */
        .restaurant-link-box {
            background: var(--bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px dashed var(--border);
        }
        
        .link-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .link-label i { color: var(--primary); }
        
        .link-input-group {
            display: flex;
            gap: 10px;
        }
        
        .link-input {
            flex: 1;
            padding: 12px 15px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--primary);
            font-family: inherit;
            font-size: 0.85rem;
            direction: ltr;
            text-align: left;
            font-weight: 600;
        }
        
        .copy-btn {
            padding: 12px 20px;
            background: var(--primary);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .copy-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .copy-btn.copied {
            background: var(--accent);
        }
        
        /* QR Button */
        .qr-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .qr-btn {
            flex: 1;
            padding: 12px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .qr-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .qr-btn i { font-size: 1.1rem; }
        
        /* Restaurant Actions */
        .restaurant-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .action-btn.enter {
            background: var(--primary);
            color: white;
            flex: 2;
        }
        
        .action-btn.enter:hover {
            background: var(--primary-dark);
        }
        
        .action-btn.edit {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .action-btn.edit:hover {
            background: var(--warning);
            color: white;
        }
        
        .action-btn.delete {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-overlay.active { display: flex; }
        
        .modal {
            background: var(--card-bg);
            border-radius: 25px;
            width: 100%;
            max-width: 550px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease;
        }
        
        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-header h3 i { color: var(--primary); }
        
        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: var(--bg);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: var(--danger);
            color: white;
        }
        
        .modal-body { padding: 30px; }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }
        
        .form-group label i {
            margin-left: 5px;
            color: var(--primary);
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 14px 18px;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .modal-footer {
            padding: 20px 30px 30px;
            display: flex;
            gap: 15px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 15px;
            border-radius: 12px;
            border: none;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-btn.cancel {
            background: var(--bg);
            color: var(--text);
        }
        
        .modal-btn.save {
            background: var(--gradient);
            color: white;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.3);
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--card-bg);
            border: 1px solid var(--border);
            padding: 15px 30px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 2000;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        .toast.success i { color: var(--accent); }
        .toast.error i { color: var(--danger); }
        
        /* Hosting Section Styles */
        .hosting-info-box {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .hosting-info-box .info-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        
        .hosting-info-box .info-content h4 {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--text);
        }
        
        .hosting-info-box .info-content ol {
            padding-right: 20px;
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.8;
        }
        
        .hosting-info-box .info-content a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }
        
        .hosting-info-box .info-content a:hover {
            text-decoration: underline;
        }
        
        .hosting-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .hosting-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            transition: all 0.3s ease;
        }
        
        .hosting-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .hosting-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .hosting-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .hosting-icon i {
            color: white;
        }
        
        .hosting-info h4 {
            font-size: 1.15rem;
            margin-bottom: 5px;
        }
        
        .hosting-info p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .hosting-status {
            margin-right: auto;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .hosting-status.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
        }

        .hosting-status.disabled {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }
        
        .hosting-status.pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }
        
        .hosting-url-box {
            background: var(--bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .hosting-url-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .hosting-url {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .hosting-url a {
            flex: 1;
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            word-break: break-all;
        }
        
        .hosting-url a:hover {
            text-decoration: underline;
        }
        
        .hosting-url button {
            padding: 8px 15px;
            background: var(--primary);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .hosting-url button:hover {
            background: var(--primary-dark);
        }
        
        .hosting-restaurant {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 10px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .hosting-restaurant i {
            color: var(--accent);
        }
        
        .hosting-restaurant span {
            flex: 1;
            font-weight: 600;
        }
        
        .hosting-restaurant.unlinked {
            background: rgba(245, 158, 11, 0.1);
            border-color: rgba(245, 158, 11, 0.3);
        }
        
        .hosting-restaurant.unlinked i {
            color: var(--warning);
        }
        
        .hosting-actions {
            display: flex;
            gap: 10px;
        }
        
        .hosting-actions button {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .hosting-actions .visit-btn {
            background: var(--primary);
            color: white;
        }
        
        .hosting-actions .deploy-btn {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .hosting-actions .delete-btn {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
            flex: 0;
            padding: 12px 15px;
        }

        .hosting-actions .stop-btn {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .hosting-actions .stop-btn.enable {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .hosting-actions button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .hosting-actions button:disabled:hover {
            transform: none;
        }
        
        .hosting-actions button:hover {
            transform: translateY(-2px);
        }
        
        /* Template Grid Cards (ØµÙØ­Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©) */
        .template-grid-card {
            background: var(--card-bg);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }
        
        .template-grid-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }
        
        .template-grid-card .template-preview {
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
            overflow: hidden;
        }
        
        .template-grid-card .template-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(to top, var(--card-bg), transparent);
        }
        
        .template-grid-card .template-content {
            padding: 20px;
        }
        
        .template-grid-card .template-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text);
        }
        
        .template-grid-card .template-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }
        
        .template-grid-card .template-actions {
            display: flex;
            gap: 10px;
        }
        
        .template-grid-card .template-actions button {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .template-grid-card .preview-btn {
            background: var(--bg);
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .template-grid-card .preview-btn:hover {
            background: var(--card-hover);
        }
        
        .template-grid-card .deploy-template-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .template-grid-card .deploy-template-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }
        
        /* Category Filters */
        .category-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 15px;
            border: 1px solid var(--border);
        }
        
        .category-filter-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 18px;
            border: 2px solid var(--border);
            border-radius: 25px;
            background: var(--bg);
            color: var(--text-secondary);
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .category-filter-btn:hover {
            border-color: var(--cat-color, var(--primary));
            color: var(--cat-color, var(--primary));
            background: var(--card-hover);
        }
        
        .category-filter-btn.active {
            background: var(--cat-color, var(--primary));
            border-color: var(--cat-color, var(--primary));
            color: white;
        }
        
        .category-filter-btn span {
            font-size: 1.1rem;
        }
        
        /* Category Section Title */
        .category-section {
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .category-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
            font-weight: 700;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }
        
        .category-title span {
            font-size: 1.5rem;
        }
        
        /* Template Category Badge */
        .template-category-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        /* Templates List Styles */
        .templates-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .template-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 16px;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .template-card:hover {
            border-color: var(--primary-light);
            background: var(--card-hover);
        }
        
        .template-card.selected {
            border-color: var(--accent);
            background: rgba(16, 185, 129, 0.1);
        }
        
        .template-card .template-icon {
            width: 55px;
            height: 55px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            flex-shrink: 0;
        }
        
        .template-card .template-info {
            flex: 1;
        }
        
        .template-card .template-info h4 {
            font-size: 1rem;
            margin-bottom: 4px;
            color: var(--text);
        }
        
        .template-card .template-info p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin: 0;
        }
        
        .template-card .template-check {
            font-size: 1.4rem;
            color: var(--accent);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .template-card.selected .template-check {
            opacity: 1;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px;
            color: var(--text-secondary);
            grid-column: 1 / -1;
        }
        
        .empty-state i {
            font-size: 4rem;
            opacity: 0.3;
            margin-bottom: 20px;
        }
        
        .empty-state h4 { font-size: 1.3rem; margin-bottom: 10px; color: var(--text); }
        
        /* Mobile Menu Button */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--gradient);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 99;
            box-shadow: 0 5px 25px rgba(99, 102, 241, 0.4);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 900px) {
            .sidebar {
                transform: translateX(100%);
            }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-right: 0; }
            .restaurants-grid { grid-template-columns: 1fr; }
            .mobile-menu-btn { display: flex; align-items: center; justify-content: center; }
        }
        
        @media (max-width: 600px) {
            .stats-grid { grid-template-columns: 1fr; }
            .header { flex-direction: column; gap: 15px; align-items: flex-start; }
            .form-row { grid-template-columns: 1fr; }
            .main-content { padding: 15px; }
        }
        
        @media (max-width: 480px) {
            .main-content { padding: 10px; }
            
            .header-title h2 { font-size: 1.2rem; }
            .header-title p { font-size: 0.85rem; }
            
            .stat-card { padding: 15px; }
            .stat-card h3 { font-size: 1.5rem; }
            .stat-card p { font-size: 0.8rem; }
            
            .restaurant-card { padding: 15px; }
            .restaurant-card h3 { font-size: 1.1rem; }
            
            .modal { width: 95%; padding: 20px; }
            .modal h3 { font-size: 1.2rem; }
            
            .form-group input,
            .form-group select { padding: 12px 15px; }
            
            .tabs { flex-wrap: wrap; }
            .tab-btn { padding: 8px 15px; font-size: 0.85rem; }
        }
        
        @media (max-width: 360px) {
            .logo h1 { font-size: 1.1rem; }
            .logo-icon { width: 40px; height: 40px; }
            
            .stat-card h3 { font-size: 1.3rem; }
            
            .header-title h2 { font-size: 1rem; }
            
            .restaurant-actions button { padding: 8px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-crown"></i>
            </div>
            <div class="logo-text">
                <h1>Ø³ÙˆØ¨Ø± Ø£Ø¯Ù…Ù†</h1>
                <p>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</p>
            </div>
        </div>
        
        <nav class="nav-menu">
            <div class="nav-item active" data-tab="restaurants">
                <i class="fas fa-store"></i>
                <span>Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</span>
            </div>
            <div class="nav-item" data-tab="hosting">
                <i class="fas fa-globe"></i>
                <span>Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³ØªØ¶Ø§ÙØ©</span>
            </div>
            <div class="nav-item" data-tab="templates">
                <i class="fas fa-palette"></i>
                <span>Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨</span>
            </div>
            <div class="nav-item" data-tab="stats">
                <i class="fas fa-chart-pie"></i>
                <span>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
            </div>
            <div class="nav-item" data-tab="shipping">
                <i class="fas fa-truck"></i>
                <span>Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†</span>
            </div>
            <div class="nav-item" data-tab="projects">
                <i class="fas fa-project-diagram"></i>
                <span>Ù…Ø´Ø§Ø±ÙŠØ¹ Firebase</span>
            </div>
            <div class="nav-item" data-tab="settings">
                <i class="fas fa-cog"></i>
                <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
            </div>
        </nav>
        
        <div class="sidebar-footer">
            <div class="admin-info">
                <div class="admin-avatar">SA</div>
                <div class="admin-details">
                    <h4>Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</h4>
                    <p>Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                </div>
            </div>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
        </div>
    </aside>
    
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Main Content -->
    <main class="main-content">
        <header class="header">
            <div class="header-title">
                <h2>ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                <p>Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</p>
            </div>
            <div class="header-actions">
                <button class="theme-btn" onclick="toggleTheme()">
                    <i class="fas fa-moon" id="theme-icon"></i>
                    <span id="theme-text">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</span>
                </button>
                <button class="add-btn" onclick="openModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ Ø¬Ø¯ÙŠØ¯
                </button>
            </div>
        </header>
        
        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-store"></i>
                </div>
                <div class="stat-value" id="total-restaurants">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-value" id="active-restaurants">0</div>
                <div class="stat-label">Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chair"></i>
                </div>
                <div class="stat-value" id="total-tables">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stat-value" id="today-date">-</div>
                <div class="stat-label">ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…</div>
            </div>
        </div>
        
        <!-- Restaurants Section -->
        <div class="section-header">
            <h3><i class="fas fa-utensils"></i> Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</h3>
            <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">Ø§Ù„ÙƒÙ„</button>
                <button class="filter-tab" data-filter="active">Ù†Ø´Ø·</button>
                <button class="filter-tab" data-filter="inactive">Ù…ØªÙˆÙ‚Ù</button>
            </div>
        </div>
        
        <div class="restaurants-grid" id="restaurants-grid">
            <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù… Ù‡Ù†Ø§ -->
        </div>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³ØªØ¶Ø§ÙØ© -->
        <div id="hosting-section" style="display: none;">
            <div class="section-header">
                <h3><i class="fas fa-globe"></i> Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³ØªØ¶Ø§ÙØ© (Firebase Hosting)</h3>
                <div style="display: flex; gap: 10px;">
                    <button class="add-btn" onclick="deployAllSites()" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <i class="fas fa-rocket"></i>
                        Ù†Ø´Ø± Ø§Ù„ÙƒÙ„
                    </button>
                    <button class="add-btn" onclick="openHostingModal()">
                        <i class="fas fa-plus"></i>
                        Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹
                    </button>
                </div>
            </div>
            
            <div class="hosting-info-box">
                <div class="info-icon"><i class="fas fa-info-circle"></i></div>
                <div class="info-content">
                    <h4>ÙƒÙŠÙÙŠØ© Ø§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</h4>
                    <ol>
                        <li>Ø´ØºÙ‘Ù„ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ: <code style="background: var(--bg); padding: 2px 8px; border-radius: 5px;">python3 server.py</code></li>
                        <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ù†Ø´Ø±" Ù„Ø£ÙŠ Ù…ÙˆÙ‚Ø¹</li>
                        <li>Ø³ÙŠØªÙ… Ø±ÙØ¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Firebase</li>
                    </ol>
                </div>
            </div>
            
            <div class="hosting-grid" id="hosting-grid">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ù‡Ù†Ø§ -->
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ -->
        <div id="templates-section" style="display: none;">
            <div class="section-header">
                <h3><i class="fas fa-palette"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨</h3>
                <div style="display: flex; gap: 10px;">
                    <button class="add-btn" onclick="clearAllCache()" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                        <i class="fas fa-broom"></i>
                        Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´
                    </button>
                    <button class="add-btn" onclick="refreshTemplates()">
                        <i class="fas fa-sync-alt"></i>
                        ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
                    </button>
                </div>
            </div>
            
            <div class="templates-info-box" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 15px; padding: 20px; margin-bottom: 25px;">
                <div style="display: flex; align-items: flex-start; gap: 15px;">
                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #a855f7, #8b5cf6); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-palette" style="color: white; font-size: 1.3rem;"></i>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 10px; color: #a855f7;">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù…ÙˆÙ‚Ø¹Ùƒ</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 10px;">
                            Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø£Ø¯Ù†Ø§Ù‡ Ø«Ù… Ø§Ø¶ØºØ· "Ù†Ø´Ø± Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹" Ù„ØªØ·Ø¨ÙŠÙ‚Ù‡ Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³ØªØ¶Ø§ÙØ©
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ -->
            <div class="stats-grid" style="margin-bottom: 25px;">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #a855f7, #8b5cf6);">
                        <i class="fas fa-palette"></i>
                    </div>
                    <div class="stat-value" id="total-templates">0</div>
                    <div class="stat-label">Ù‚ÙˆØ§Ù„Ø¨ Ù…ØªØ§Ø­Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <i class="fas fa-globe"></i>
                    </div>
                    <div class="stat-value" id="total-sites-for-templates">0</div>
                    <div class="stat-label">Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø³ØªØ¶Ø§ÙØ©</div>
                </div>
            </div>
            
            <!-- Ø£Ø²Ø±Ø§Ø± ØªØµÙÙŠØ© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… -->
            <div id="category-filters" class="category-filters" style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 25px;">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ù‡Ù†Ø§ -->
            </div>
            
            <!-- Ø´Ø¨ÙƒØ© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ -->
            <div class="templates-grid" id="templates-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px;">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ù‡Ù†Ø§ -->
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† -->
        <div id="shipping-section" style="display: none;">
            <div class="section-header">
                <h3><i class="fas fa-truck"></i> Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† ÙˆØ®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
                <button class="add-btn" onclick="openShippingModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø´Ø­Ù†
                </button>
            </div>
            
            <div class="shipping-info-box" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 15px; padding: 20px; margin-bottom: 25px;">
                <div style="display: flex; align-items: flex-start; gap: 15px;">
                    <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-code" style="color: white; font-size: 1.3rem;"></i>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 10px; color: #10b981;">API Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 10px;">
                            ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø· Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ­Ø³Ø§Ø¨ ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªÙˆØµÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                        </p>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            <span style="background: var(--bg); padding: 5px 12px; border-radius: 20px; font-size: 0.8rem;">
                                <i class="fas fa-check" style="color: #10b981;"></i> ØªØªØ¨Ø¹ Ø§Ù„Ø´Ø­Ù†Ø§Øª
                            </span>
                            <span style="background: var(--bg); padding: 5px 12px; border-radius: 20px; font-size: 0.8rem;">
                                <i class="fas fa-check" style="color: #10b981;"></i> Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©
                            </span>
                            <span style="background: var(--bg); padding: 5px 12px; border-radius: 20px; font-size: 0.8rem;">
                                <i class="fas fa-check" style="color: #10b981;"></i> Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙˆØ±ÙŠØ©
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø­Ù† -->
            <div class="stats-grid" style="margin-bottom: 25px;">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <i class="fas fa-truck"></i>
                    </div>
                    <div class="stat-value" id="total-shipping-companies">0</div>
                    <div class="stat-label">Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">
                        <i class="fas fa-link"></i>
                    </div>
                    <div class="stat-value" id="active-apis">0</div>
                    <div class="stat-label">APIs Ù†Ø´Ø·Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <div class="stat-value" id="total-shipments">0</div>
                    <div class="stat-label">Ø´Ø­Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-value" id="shipping-revenue">0</div>
                    <div class="stat-label">Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø­Ù†</div>
                </div>
            </div>
            
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† -->
            <div class="shipping-grid" id="shipping-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px;">
                <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† Ù‡Ù†Ø§ -->
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div id="stats-section" style="display: none;">
            <div class="section-header">
                <h3><i class="fas fa-chart-line"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
                <button class="add-btn" onclick="refreshSuperAdminStats()">
                    <i class="fas fa-sync"></i>
                    ØªØ­Ø¯ÙŠØ«
                </button>
            </div>

            <div class="stats-grid" style="margin-bottom: 25px;">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="stat-value" id="sa-stats-total-restaurants">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-value" id="sa-stats-active-restaurants">0</div>
                    <div class="stat-label">Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <div class="stat-value" id="sa-stats-hosting-sites">0</div>
                    <div class="stat-label">Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³ØªØ¶Ø§ÙØ©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <div class="stat-value" id="sa-stats-shipping-companies">0</div>
                    <div class="stat-label">Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†</div>
                </div>
            </div>

            <div class="hosting-info-box">
                <div class="info-icon"><i class="fas fa-info-circle"></i></div>
                <div class="info-content">
                    <h4>Ù…Ù„Ø§Ø­Ø¸Ø©</h4>
                    <p>Ù‡Ø°Ù‡ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¹Ø§Ù…Ø© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù‘Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ….</p>
                </div>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ù…Ø´Ø§Ø±ÙŠØ¹ Firebase -->
        <div id="projects-section" style="display: none;">
            <div class="section-header">
                <h3><i class="fas fa-project-diagram"></i> Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Firebase</h3>
                <button class="btn btn-primary" onclick="openProjectModal()">
                    <i class="fas fa-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯
                </button>
            </div>

            <div class="hosting-info-box" style="margin-bottom: 20px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1)); border: 1px solid rgba(99, 102, 241, 0.3);">
                <div class="info-icon"><i class="fas fa-info-circle"></i></div>
                <div class="info-content">
                    <h4>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h4>
                    <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø¹Ø¯Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Firebase ÙÙŠ Ø­Ø³Ø§Ø¨ ÙˆØ§Ø­Ø¯. Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ù„ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹.</p>
                </div>
            </div>

            <div id="projects-grid" class="hosting-grid">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
        <div id="settings-section" style="display: none;">
            <div class="section-header">
                <h3><i class="fas fa-cog"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
            </div>

            <div class="hosting-info-box" style="margin-bottom: 20px;">
                <div class="info-icon"><i class="fas fa-user-shield"></i></div>
                <div class="info-content">
                    <h4>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</h4>
                    <p>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: <strong id="sa-settings-admin-name">-</strong></p>
                    <p>Ø§Ù„Ø­Ø§Ù„Ø©: <strong id="sa-settings-firebase-status">-</strong></p>
                </div>
            </div>

            <div class="hosting-info-box" style="margin-bottom: 20px;">
                <div class="info-icon"><i class="fas fa-sliders-h"></i></div>
                <div class="info-content">
                    <h4>Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</h4>
                    <div class="form-row" style="margin-top: 15px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="sa-setting-theme"><i class="fas fa-adjust"></i> Ø§Ù„Ù…Ø¸Ù‡Ø±</label>
                            <select id="sa-setting-theme">
                                <option value="dark">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</option>
                                <option value="light">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="sa-setting-default-tab"><i class="fas fa-layer-group"></i> Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</label>
                            <select id="sa-setting-default-tab">
                                <option value="restaurants">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</option>
                                <option value="hosting">Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©</option>
                                <option value="stats">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</option>
                                <option value="shipping">Ø§Ù„Ø´Ø­Ù†</option>
                                <option value="settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row" style="margin-top: 15px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label for="sa-setting-auto-refresh"><i class="fas fa-sync"></i> Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</label>
                            <select id="sa-setting-auto-refresh">
                                <option value="0">Ø¥ÙŠÙ‚Ø§Ù</option>
                                <option value="30">ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©</option>
                                <option value="60">ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©</option>
                                <option value="120">ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label><i class="fas fa-save"></i> ØªØ·Ø¨ÙŠÙ‚</label>
                            <div style="display: flex; gap: 10px;">
                                <button class="add-btn" onclick="saveSuperAdminPreferences()" style="flex: 1;">
                                    <i class="fas fa-check"></i>
                                    Ø­ÙØ¸
                                </button>
                                <button class="add-btn" onclick="resetSuperAdminPreferences()" style="flex: 1; background: var(--bg); color: var(--text); border: 1px solid var(--border); box-shadow: none;">
                                    <i class="fas fa-undo"></i>
                                    Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="hosting-info-box">
                <div class="info-icon"><i class="fas fa-tools"></i></div>
                <div class="info-content">
                    <h4>Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h4>
                    <p style="margin-bottom: 15px;">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø­Ø°Ø±.</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <button class="add-btn" onclick="initializeDefaultDataFromSettings()">
                            <i class="fas fa-database"></i>
                            ØªÙ‡ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                        </button>
                        <button class="add-btn" onclick="clearSuperAdminSession()" style="background: var(--danger);">
                            <i class="fas fa-sign-out-alt"></i>
                            Ù…Ø³Ø­ Ø¬Ù„Ø³Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Modal -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-store"></i> <span id="modal-title">Ø¥Ø¶Ø§ÙØ© Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ Ø¬Ø¯ÙŠØ¯</span></h3>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="restaurant-form">
                    <input type="hidden" id="edit-id">
                    
                    <div class="form-group">
                        <label><i class="fas fa-store"></i> Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</label>
                        <input type="text" id="r-name" placeholder="Ù…Ø«Ø§Ù„: Ù†Ø´Ø§Ø· Ø§Ù„Ø´Ø±Ù‚" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-tag"></i> Ø§Ù„Ù†ÙˆØ¹</label>
                            <select id="r-type">
                                <option value="restaurant">ğŸ½ï¸ Ù…Ø·Ø¹Ù…</option>
                                <option value="cafe">â˜• ÙƒØ§ÙÙŠÙ‡</option>
                                <option value="fastfood">ğŸ” ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©</option>
                                <option value="bakery">ğŸ¥ Ù…Ø®Ø¨Ø²</option>
                                <option value="juice">ğŸ¥¤ Ø¹ØµØ§Ø¦Ø±</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-chair"></i> Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª</label>
                            <input type="number" id="r-tables" value="10" min="1" max="100">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                            <input type="text" id="r-username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ø¯Ø®ÙˆÙ„" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-lock"></i> ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                            <input type="text" id="r-password" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù†Ø´Ø§Ø·" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-phone"></i> Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                        <input type="tel" id="r-phone" placeholder="99XXXXXX">
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-map-marker-alt"></i> Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                        <input type="text" id="r-address" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø§Ù„Ø­ÙŠ">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="modal-btn save" onclick="saveRestaurant()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toast -->
    <div class="toast success" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-text">ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­</span>
    </div>
    
    <!-- Hosting Modal -->
    <div class="modal-overlay" id="hosting-modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-globe"></i> <span id="hosting-modal-title">Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹ Ù…Ø³ØªØ¶Ø§Ù</span></h3>
                <button class="modal-close" onclick="closeHostingModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="hosting-form">
                    <input type="hidden" id="hosting-edit-id">
                    
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø§Ù„Ù…Ø¹Ø±Ù‘Ù)</label>
                        <input type="text" id="h-site-id" placeholder="Ù…Ø«Ø§Ù„: bon-coffee-1" list="hosting-site-id-list" required>
                        <datalist id="hosting-site-id-list"></datalist>
                        <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                            Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ø°ÙŠ Ø£Ù†Ø´Ø£ØªÙ‡ ÙÙŠ Firebase Console.
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-store"></i> Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¶</label>
                        <input type="text" id="h-display-name" placeholder="Ù…Ø«Ø§Ù„: ÙƒØ§ÙÙŠÙ‡ Ø¨ÙˆÙ†">
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-link"></i> Ø±Ø¨Ø· Ø¨Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ</label>
                        <select id="h-restaurant">
                            <option value="">-- Ø¨Ø¯ÙˆÙ† Ø±Ø¨Ø· --</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-info-circle"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <input type="text" id="h-notes" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeHostingModal()">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="modal-btn save" onclick="saveHostingSite()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸
                </button>
            </div>
        </div>
    </div>
    
    <!-- Deploy Modal - Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù„Ù„Ù†Ø´Ø± -->
    <div class="modal-overlay" id="deploy-modal-overlay">
        <div class="modal" style="max-width: 650px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #10b981, #059669);">
                <h3><i class="fas fa-rocket"></i> Ù†Ø´Ø± Ø¹Ù„Ù‰ <span id="deploy-site-name">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span></h3>
                <button class="modal-close" onclick="closeDeployModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px; color: var(--text);"><i class="fas fa-palette"></i> Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù„Ù„Ù†Ø´Ø±</h4>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Ø­Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ù†Ø´Ø±Ù‡ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
                </div>
                
                <div id="templates-list" class="templates-list">
                    <!-- Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ù‡Ù†Ø§ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeDeployModal()">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="modal-btn save" onclick="confirmDeploy()" style="background: linear-gradient(135deg, #10b981, #059669);">
                    <i class="fas fa-rocket"></i> Ù†Ø´Ø± Ø§Ù„Ø¢Ù†
                </button>
            </div>
        </div>
    </div>
    
    <!-- Shipping Modal -->
    <div class="modal-overlay" id="shipping-modal-overlay">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #10b981, #059669);">
                <h3><i class="fas fa-truck"></i> <span id="shipping-modal-title">Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø´Ø­Ù†</span></h3>
                <button class="modal-close" onclick="closeShippingModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="shipping-form">
                    <input type="hidden" id="shipping-edit-id">
                    
                    <!-- Ù‚Ø³Ù… API Key Ø§Ù„Ù…ÙˆÙ„Ù‘Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
                    <div id="generated-api-section" style="display: none; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); border: 2px solid #10b981; border-radius: 12px; padding: 15px; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <i class="fas fa-key" style="color: #10b981; font-size: 1.2rem;"></i>
                            <strong style="color: #10b981;">Ù…ÙØªØ§Ø­ API Ù„Ù„Ø´Ø±ÙƒØ©</strong>
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="s-generated-api-key" readonly style="flex: 1; background: white; border: 1px solid #10b981; padding: 10px; border-radius: 8px; font-family: monospace; font-size: 0.9rem;">
                            <button type="button" onclick="copyApiKey()" style="background: #10b981; color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer;">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button type="button" onclick="regenerateApiKey()" style="background: #f59e0b; color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer;" title="ØªÙˆÙ„ÙŠØ¯ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                        <small style="color: #666; display: block; margin-top: 8px;"><i class="fas fa-info-circle"></i> Ø§Ø­ÙØ¸ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙØªØ§Ø­! Ø³ÙŠØ³ØªØ®Ø¯Ù… Ù„Ù„Ø±Ø¨Ø· Ù…Ø¹ ØµÙØ­Ø© Ø§Ù„Ø´Ø±ÙƒØ©</small>
                    </div>
                    
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label><i class="fas fa-building"></i> Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</label>
                            <input type="text" id="s-company-name" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-tag"></i> Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø®ØªØµØ±</label>
                            <input type="text" id="s-company-code" placeholder="Ù…Ø«Ø§Ù„: FAST" style="text-transform: uppercase;">
                        </div>
                    </div>
                    
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label><i class="fas fa-money-bill"></i> Ø³Ø¹Ø± Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø±.Ø¹)</label>
                            <input type="number" id="s-base-price" placeholder="1.000" step="0.001" min="0">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-weight"></i> Ø³Ø¹Ø± Ø§Ù„ÙƒÙŠÙ„Ùˆ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ (Ø±.Ø¹)</label>
                            <input type="number" id="s-price-per-kg" placeholder="0.500" step="0.001" min="0">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-map-marker-alt"></i> Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªØºØ·ÙŠØ©</label>
                        <input type="text" id="s-coverage-areas" placeholder="Ù…Ø³Ù‚Ø·ØŒ ØµÙ„Ø§Ù„Ø©ØŒ ØµØ­Ø§Ø±... (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„)">
                    </div>
                    
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label><i class="fas fa-phone"></i> Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</label>
                            <input type="tel" id="s-phone" placeholder="968XXXXXXXX">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-envelope"></i> Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                            <input type="email" id="s-email" placeholder="support@company.com">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-image"></i> Ø´Ø¹Ø§Ø± Ø§Ù„Ø´Ø±ÙƒØ© (Ø±Ø§Ø¨Ø·)</label>
                        <input type="url" id="s-logo" placeholder="https://example.com/logo.png">
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-toggle-on"></i> Ø§Ù„Ø­Ø§Ù„Ø©</label>
                        <select id="s-status">
                            <option value="active">Ù†Ø´Ø·</option>
                            <option value="inactive">Ù…ØªÙˆÙ‚Ù</option>
                            <option value="testing">ØªØ¬Ø±ÙŠØ¨ÙŠ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-sticky-note"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <textarea id="s-notes" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..." rows="2" style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--bg); color: var(--text); font-family: inherit; resize: vertical;"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeShippingModal()">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="modal-btn save" onclick="saveShippingCompany()" style="background: linear-gradient(135deg, #10b981, #059669);">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø´Ø±ÙƒØ©
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…Ø´Ø±ÙˆØ¹ Firebase -->
    <div class="modal-overlay" id="project-modal-overlay">
        <div class="modal-container" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="project-modal-title"><i class="fas fa-project-diagram"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Firebase Ø¬Ø¯ÙŠØ¯</h3>
                <button class="modal-close" onclick="closeProjectModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="project-form">
                    <input type="hidden" id="project-edit-id">
                    
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Project ID)</label>
                        <input type="text" id="project-id" placeholder="Ù…Ø«Ø§Ù„: my-project-123" required>
                        <small style="color: var(--text-secondary);">Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙÙŠ Firebase Console</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-heading"></i> Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¶</label>
                        <input type="text" id="project-display-name" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„" required>
                        <small style="color: var(--text-secondary);">Ø§Ø³Ù… ÙŠØ¸Ù‡Ø± ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-key"></i> API Key</label>
                        <input type="text" id="project-api-key" placeholder="AIzaSy..." required>
                        <small style="color: var(--text-secondary);">Ù…ÙØªØ§Ø­ API Ù…Ù† Firebase Console</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-database"></i> Database URL</label>
                        <input type="text" id="project-database-url" placeholder="https://project-id-default-rtdb.firebaseio.com" required>
                        <small style="color: var(--text-secondary);">Ø±Ø§Ø¨Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-link"></i> Auth Domain</label>
                        <input type="text" id="project-auth-domain" placeholder="project-id.firebaseapp.com" required>
                        <small style="color: var(--text-secondary);">Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-storage"></i> Storage Bucket</label>
                        <input type="text" id="project-storage-bucket" placeholder="project-id.appspot.com">
                        <small style="color: var(--text-secondary);">Ø­Ø²Ù…Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-id-badge"></i> Messaging Sender ID</label>
                        <input type="text" id="project-messaging-sender-id" placeholder="123456789">
                        <small style="color: var(--text-secondary);">Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-app"></i> App ID</label>
                        <input type="text" id="project-app-id" placeholder="1:123456789:web:abc123">
                        <small style="color: var(--text-secondary);">Ù…Ø¹Ø±Ù‘Ù Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</small>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-toggle-on"></i> Ø§Ù„Ø­Ø§Ù„Ø©</label>
                        <select id="project-status">
                            <option value="active">Ù†Ø´Ø·</option>
                            <option value="inactive">ØºÙŠØ± Ù†Ø´Ø·</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-sticky-note"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <textarea id="project-notes" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..." rows="3" style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--bg); color: var(--text); font-family: inherit; resize: vertical;"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeProjectModal()">Ø¥Ù„ØºØ§Ø¡</button>
                <button class="modal-btn save" onclick="saveProject()" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
                </button>
            </div>
        </div>
    </div>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="js/performance.js"></script>
    <script src="js/firebase-config.js"></script>
    
    <script>
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    if (!localStorage.getItem('superAdminLoggedIn')) {
        window.location.href = 'login.html';
    }
    
    let restaurants = [];
    let hostingSites = [];
    let currentFilter = 'all';
    const BASE_URL = window.location.origin;
    let superAdminAutoRefreshInterval = null;
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ ÙˆÙ…Ø²Ø§Ù…Ù†Ø© Ù…ÙˆØ§Ù‚Ø¹ Firebase Hosting ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù€ API
    async function syncFirebaseHostingSites() {
        try {
            // Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ (Ø§Ù„Ø°ÙŠ ÙŠØ³ØªØ®Ø¯Ù… Firebase CLI)
            const response = await fetch('/api/hosting/sites?project=restaurant-system-demo');
            const data = await response.json();
            
            if (data.success && Array.isArray(data.sites)) {
                console.log('ğŸ“¡ ØªÙ… Ø¬Ù„Ø¨ Ù…ÙˆØ§Ù‚Ø¹ Firebase Hosting:', data.sites);
                
                for (const siteId of data.sites) {
                    const exists = hostingSites.some(s => s.siteId === siteId);
                    if (!exists && window.FirebaseDB && typeof FirebaseDB.saveSite === 'function') {
                        try {
                            await FirebaseDB.saveSite(siteId, {
                                displayName: siteId,
                                notes: 'ØªÙ…Øª Ø¥Ø¶Ø§ÙØªÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Firebase Hosting',
                                status: 'active',
                                createdAt: new Date().toISOString()
                            });
                            console.log(`âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹ Ø¬Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹: ${siteId}`);
                        } catch (e) {
                            console.log(`âš ï¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹: ${siteId}`);
                        }
                    }
                }
            } else {
                console.log('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…ÙˆØ§Ù‚Ø¹ Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£:', data.error);
            }
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ù…ÙˆØ§Ù‚Ø¹ Firebase Hosting:', error);
        }
    }

    document.addEventListener('DOMContentLoaded', async function() {
        try {
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
            await loadDataFromFirebase();
            
            // Ù…Ø²Ø§Ù…Ù†Ø© Ù…ÙˆØ§Ù‚Ø¹ Firebase Hosting
            await syncFirebaseHostingSites();
            await loadDataFromFirebase(); // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase:', error);
            // Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø­ØªÙ‰ Ù„Ùˆ ÙØ´Ù„ Firebase
        }
        
        try {
            loadRestaurants();
            updateStats();
            renderSuperAdminStatsSection();
            renderSuperAdminSettingsSection();
            applySuperAdminPreferences(loadSuperAdminPreferences(), { applyDefaultTab: false });
            setupFilters();
            loadTheme();
            
            // ØªØ­Ù…ÙŠÙ„ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†
            loadShippingCompanies();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ®
            const today = new Date().toLocaleDateString('ar-SA', { day: 'numeric', month: 'short' });
            const todayDateEl = document.getElementById('today-date');
            if (todayDateEl) {
                todayDateEl.textContent = today;
            }

            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙØ¶ÙŠÙ„Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø±Ø¨Ø· Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª)
            setTimeout(() => {
                applySuperAdminPreferences(loadSuperAdminPreferences(), { applyDefaultTab: true });
            }, 0);
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©:', error);
        }
        
        // Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠ Ø´Ø§Ø´Ø© ØªØ­Ù…ÙŠÙ„
        const loaders = document.querySelectorAll('.loader, .loading, [class*="loading"]');
        loaders.forEach(loader => loader.style.display = 'none');
    });
    
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('open');
    }
    
    function setupFilters() {
        document.querySelectorAll('.filter-tab').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-tab').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.filter;
                loadRestaurants();
            });
        });
    }
    
    function loadRestaurants() {
        const container = document.getElementById('restaurants-grid');
        let filtered = [...restaurants];
        
        if (currentFilter === 'active') {
            filtered = filtered.filter(r => r.status === 'active');
        } else if (currentFilter === 'inactive') {
            filtered = filtered.filter(r => r.status === 'inactive');
        }
        
        if (filtered.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-store"></i>
                    <h4>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·Ø§Øª ØªØ¬Ø§Ø±ÙŠØ©</h4>
                    <p>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ Ø¬Ø¯ÙŠØ¯" Ù„Ù„Ø¨Ø¯Ø¡</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = filtered.map(r => {
            const icon = getTypeIcon(r.type);
            const typeName = getTypeName(r.type);
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ø§Ù„Ù…Ø·Ø¹Ù…
            const linkedSite = hostingSites.find(s => s.restaurantId === r.id);
            const siteUrl = linkedSite ? `https://${linkedSite.siteId}.web.app` : BASE_URL;
            const restaurantUrl = `${siteUrl}/index.html?r=${r.id}`;
            const menuUrl = `${siteUrl}/menu.html?r=${r.id}`;
            
            return `
                <div class="restaurant-card">
                    <div class="restaurant-header">
                        <div class="restaurant-icon">${icon}</div>
                        <span class="restaurant-status ${r.status}">${r.status === 'active' ? 'âœ“ Ù†Ø´Ø·' : 'âœ• Ù…ØªÙˆÙ‚Ù'}</span>
                    </div>
                    <div class="restaurant-body">
                        <h3 class="restaurant-name">${r.name}</h3>
                        <p class="restaurant-type">${typeName} â€¢ ${r.address || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</p>
                        
                        <div class="restaurant-stats">
                            <div class="r-stat">
                                <div class="r-stat-value">${r.tables}</div>
                                <div class="r-stat-label">Ø·Ø§ÙˆÙ„Ø©</div>
                            </div>
                            <div class="r-stat">
                                <div class="r-stat-value">#${r.id}</div>
                                <div class="r-stat-label">Ø§Ù„Ù…Ø¹Ø±Ù‘Ù</div>
                            </div>
                            <div class="r-stat">
                                <div class="r-stat-value">${r.password}</div>
                                <div class="r-stat-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</div>
                            </div>
                        </div>
                        
                        <div class="restaurant-link-box">
                            <div class="link-label">
                                <i class="fas fa-link"></i>
                                Ø±Ø§Ø¨Ø· Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù†Ø´Ø§Ø·
                            </div>
                            <div class="link-input-group">
                                <input type="text" class="link-input" value="${restaurantUrl}" readonly id="link-${r.id}">
                                <button class="copy-btn" onclick='copyLink(${JSON.stringify(r.id)}, "link")'>
                                    <i class="fas fa-copy"></i>
                                    Ù†Ø³Ø®
                                </button>
                            </div>
                        </div>
                        
                        <div class="restaurant-link-box" style="border-color: var(--accent);">
                            <div class="link-label">
                                <i class="fas fa-qrcode" style="color: var(--accent);"></i>
                                Ø±Ø§Ø¨Ø· Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ø¹Ø§Ù… (Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡)
                            </div>
                            <div class="link-input-group">
                                <input type="text" class="link-input" value="${menuUrl}" readonly id="menu-${r.id}" style="color: var(--accent);">
                                <button class="copy-btn" onclick='copyLink(${JSON.stringify(r.id)}, "menu")' style="background: var(--accent);">
                                    <i class="fas fa-copy"></i>
                                    Ù†Ø³Ø®
                                </button>
                            </div>
                        </div>
                        
                        <div class="qr-section">
                            <button class="qr-btn" onclick='openQRGenerator(${JSON.stringify(r.id)})'>
                                <i class="fas fa-qrcode"></i>
                                ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ QR Ù„Ù„Ø·Ø§ÙˆÙ„Ø§Øª
                            </button>
                        </div>
                        
                        <div class="restaurant-actions">
                            <button class="action-btn enter" onclick='enterRestaurant(${JSON.stringify(r.id)})'>
                                <i class="fas fa-sign-in-alt"></i>
                                Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                            </button>
                            <button class="action-btn edit" onclick='editRestaurant(${JSON.stringify(r.id)})'>
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" onclick='deleteRestaurant(${JSON.stringify(r.id)})'>
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    function getTypeIcon(type) {
        const icons = {
            restaurant: 'ğŸ½ï¸',
            cafe: 'â˜•',
            fastfood: 'ğŸ”',
            bakery: 'ğŸ¥',
            juice: 'ğŸ¥¤'
        };
        return icons[type] || 'ğŸ½ï¸';
    }
    
    function getTypeName(type) {
        const names = {
            restaurant: 'Ù…Ø·Ø¹Ù…',
            cafe: 'ÙƒØ§ÙÙŠÙ‡',
            fastfood: 'ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©',
            bakery: 'Ù…Ø®Ø¨Ø²',
            juice: 'Ø¹ØµØ§Ø¦Ø±'
        };
        return names[type] || 'Ù…Ø·Ø¹Ù…';
    }
    
    function updateStats() {
        document.getElementById('total-restaurants').textContent = restaurants.length;
        document.getElementById('active-restaurants').textContent = restaurants.filter(r => r.status === 'active').length;
        document.getElementById('total-tables').textContent = restaurants.reduce((sum, r) => sum + (r.tables || 0), 0);
    }
    
    function copyLink(id, type) {
        const inputId = type === 'menu' ? `menu-${id}` : `link-${id}`;
        const input = document.getElementById(inputId);
        input.select();
        document.execCommand('copy');
        
        const btn = input.nextElementSibling;
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®';
        btn.classList.add('copied');
        
        setTimeout(() => {
            btn.innerHTML = originalHTML;
            btn.classList.remove('copied');
        }, 2000);
        
        showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­');
    }
    
    function enterRestaurant(id) {
        const restaurant = restaurants.find(r => r.id === id);
        if (restaurant) {
            localStorage.setItem('currentRestaurant', JSON.stringify(restaurant));
            window.open(`index.html?r=${id}`, '_blank');
        }
    }
    
    function openQRGenerator(id) {
        const restaurant = restaurants.find(r => r.id === id);
        if (restaurant) {
            localStorage.setItem('currentRestaurant', JSON.stringify(restaurant));
            window.open(`admin.html?r=${id}`, '_blank');
        }
    }
    
    function openModal(id = null) {
        document.getElementById('modal-overlay').classList.add('active');
        document.getElementById('modal-title').textContent = id ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠ' : 'Ø¥Ø¶Ø§ÙØ© Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ Ø¬Ø¯ÙŠØ¯';
        
        if (id) {
            const r = restaurants.find(r => r.id === id);
            if (r) {
                document.getElementById('edit-id').value = r.id;
                document.getElementById('r-name').value = r.name;
                document.getElementById('r-type').value = r.type;
                document.getElementById('r-tables').value = r.tables;
                document.getElementById('r-phone').value = r.phone || '';
                document.getElementById('r-username').value = r.username || '';
                document.getElementById('r-password').value = r.password;
                document.getElementById('r-address').value = r.address || '';
            }
        } else {
            document.getElementById('restaurant-form').reset();
            document.getElementById('edit-id').value = '';
            document.getElementById('r-tables').value = 10;
        }
    }
    
    function closeModal() {
        document.getElementById('modal-overlay').classList.remove('active');
    }
    
    function editRestaurant(id) {
        openModal(id);
    }
    
    async function saveRestaurant() {
        const editId = document.getElementById('edit-id').value;
        const data = {
            name: document.getElementById('r-name').value,
            type: document.getElementById('r-type').value,
            tables: parseInt(document.getElementById('r-tables').value),
            phone: document.getElementById('r-phone').value,
            username: document.getElementById('r-username').value,
            password: document.getElementById('r-password').value,
            address: document.getElementById('r-address').value,
            status: 'active'
        };
        
        if (!data.name || !data.username || !data.password) {
            showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
            return;
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        const existingUser = restaurants.find(r => r.username === data.username && r.id !== editId);
        if (existingUser) {
            showToast('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ø§Ø®ØªØ± Ø§Ø³Ù… Ø¢Ø®Ø±', 'error');
            return;
        }
        
        try {
            if (editId) {
                // ØªØ­Ø¯ÙŠØ« Ù…Ø·Ø¹Ù… Ù…ÙˆØ¬ÙˆØ¯
                await FirebaseDB.saveRestaurant(editId, { ...data, updatedAt: new Date().toISOString() });
                const idx = restaurants.findIndex(r => r.id === editId);
                if (idx !== -1) {
                    restaurants[idx] = { ...restaurants[idx], ...data };
                }
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø·Ø¹Ù… Ø¬Ø¯ÙŠØ¯
                const newId = 'r-' + Date.now();
                data.id = newId;
                data.createdAt = new Date().toISOString();
                await FirebaseDB.saveRestaurant(newId, data);
                restaurants.push(data);
            }
            
            saveRestaurants();
            loadRestaurants();
            updateStats();
            closeModal();
            showToast(editId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø·Ø¹Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ…' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø·Ø¹Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ…');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø·Ø¹Ù…:', error);
            showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸', 'error');
        }
    }
    
    async function deleteRestaurant(id) {
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠØŸ\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡.')) {
            try {
                // Ø­Ø°Ù Ù…Ù† Firebase
                await FirebaseDB.deleteRestaurant(id);
                
                restaurants = restaurants.filter(r => r.id !== id);
                
                // Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø¹Ù… Ù…Ù† localStorage
                localStorage.removeItem(`r${id}_orders`);
                localStorage.removeItem(`r${id}_tables`);
                localStorage.removeItem(`r${id}_menuItems`);
                
                saveRestaurants();
                loadRestaurants();
                updateStats();
                showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¬Ø§Ø±ÙŠ Ø¨Ù†Ø¬Ø§Ø­ âœ…');
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø·Ø¹Ù…:', error);
                showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù', 'error');
            }
        }
    }
    
    function saveRestaurants() {
        localStorage.setItem('restaurants', JSON.stringify(restaurants));
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
    async function loadDataFromFirebase() {
        try {
            // Ø¥Ø¶Ø§ÙØ© timeout Ù„Ù„ØªØ­Ù…ÙŠÙ„
            const loadPromise = Promise.all([
                FirebaseDB.getRestaurants().catch(e => {
                    console.warn('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…:', e);
                    return [];
                }),
                FirebaseDB.getSites().catch(e => {
                    console.warn('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹:', e);
                    return {};
                })
            ]);
            
            const timeoutPromise = new Promise((_, reject) => 
                setTimeout(() => reject(new Error('Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„')), 10000)
            );
            
            const [restaurantsData, sitesData] = await Promise.race([
                loadPromise,
                timeoutPromise
            ]).catch(() => {
                // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ´Ù„ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                console.warn('Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ø³Ø¨Ø¨ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„');
                return [[], {}];
            });
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
            restaurants = Array.isArray(restaurantsData) ? restaurantsData : [];
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
            const safeSites = sitesData && typeof sitesData === 'object' ? sitesData : {};
            hostingSites = Object.keys(safeSites).map(key => ({
                id: key,
                siteId: key,
                ...safeSites[key]
            }));

            // Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ù…Ø­Ù„ÙŠØ© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù†Ø¯ Ø¹Ø¯Ù… Ø§Ù„Ø§ØªØµØ§Ù„
            try {
                localStorage.setItem('restaurants', JSON.stringify(restaurants || []));
                localStorage.setItem('hostingSites', JSON.stringify(hostingSites || []));
            } catch (e) {
                // ignore
            }
            
            console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙƒÙ€ fallback
            restaurants = JSON.parse(localStorage.getItem('restaurants') || '[]');
            hostingSites = JSON.parse(localStorage.getItem('hostingSites') || '[]');
        }
    }
    
    // Ø­ÙØ¸ Ø§Ù„Ù…Ø·Ø¹Ù… ÙÙŠ Firebase
    async function saveRestaurantToFirebase(restaurant) {
        try {
            await FirebaseDB.saveRestaurant(restaurant.id, restaurant);
            console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø·Ø¹Ù… ÙÙŠ Firebase');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø·Ø¹Ù…:', error);
        }
    }
    
    // Ø­Ø°Ù Ø§Ù„Ù…Ø·Ø¹Ù… Ù…Ù† Firebase
    async function deleteRestaurantFromFirebase(restaurantId) {
        try {
            await FirebaseDB.deleteRestaurant(restaurantId);
            console.log('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø·Ø¹Ù… Ù…Ù† Firebase');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø·Ø¹Ù…:', error);
        }
    }
    
    function toggleTheme() {
        document.body.classList.toggle('light-mode');
        const isLight = document.body.classList.contains('light-mode');
        localStorage.setItem('theme', isLight ? 'light' : 'dark');
        updateThemeUI();
    }
    
    function loadTheme() {
        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-mode');
        }
        updateThemeUI();
    }
    
    function updateThemeUI() {
        const isLight = document.body.classList.contains('light-mode');
        document.getElementById('theme-icon').className = isLight ? 'fas fa-sun' : 'fas fa-moon';
        document.getElementById('theme-text').textContent = isLight ? 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ' : 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ';
    }
    
    function logout() {
        if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
            localStorage.removeItem('superAdminLoggedIn');
            window.location.href = 'login.html';
        }
    }
    
    function showToast(message, type = 'success') {
        const toast = document.getElementById('toast');
        const toastIcon = toast.querySelector('i');
        document.getElementById('toast-text').textContent = message;
        
        toast.className = 'toast ' + type;
        toastIcon.className = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
        
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 3000);
    }

    function renderSuperAdminStatsSection() {
        const totalRestaurantsEl = document.getElementById('sa-stats-total-restaurants');
        const activeRestaurantsEl = document.getElementById('sa-stats-active-restaurants');
        const hostingSitesEl = document.getElementById('sa-stats-hosting-sites');
        const shippingCompaniesEl = document.getElementById('sa-stats-shipping-companies');

        const totalRestaurants = Array.isArray(restaurants) ? restaurants.length : 0;
        const activeRestaurants = Array.isArray(restaurants) ? restaurants.filter(r => r.status === 'active').length : 0;
        const totalHostingSites = Array.isArray(hostingSites) ? hostingSites.length : 0;
        const totalShippingCompanies = Array.isArray(shippingCompanies) ? shippingCompanies.length : 0;

        if (totalRestaurantsEl) totalRestaurantsEl.textContent = totalRestaurants;
        if (activeRestaurantsEl) activeRestaurantsEl.textContent = activeRestaurants;
        if (hostingSitesEl) hostingSitesEl.textContent = totalHostingSites;
        if (shippingCompaniesEl) shippingCompaniesEl.textContent = totalShippingCompanies;
    }

    function renderSuperAdminSettingsSection() {
        const adminNameEl = document.getElementById('sa-settings-admin-name');
        const firebaseStatusEl = document.getElementById('sa-settings-firebase-status');
        const themeSelect = document.getElementById('sa-setting-theme');
        const defaultTabSelect = document.getElementById('sa-setting-default-tab');
        const autoRefreshSelect = document.getElementById('sa-setting-auto-refresh');

        let adminLabel = '-';
        try {
            const raw = localStorage.getItem('currentAdmin');
            if (raw) {
                const obj = JSON.parse(raw);
                adminLabel = obj?.email || obj?.name || obj?.username || adminLabel;
            }
        } catch (e) {
            // ignore
        }

        const firebaseOk = typeof database !== 'undefined';
        if (adminNameEl) adminNameEl.textContent = adminLabel;
        if (firebaseStatusEl) firebaseStatusEl.textContent = firebaseOk ? 'Ù…ØªØµÙ„' : 'ØºÙŠØ± Ù…ØªØµÙ„';

        const prefs = loadSuperAdminPreferences();
        if (themeSelect) themeSelect.value = prefs.theme;
        if (defaultTabSelect) defaultTabSelect.value = prefs.defaultTab;
        if (autoRefreshSelect) autoRefreshSelect.value = String(prefs.autoRefreshSec);
    }

    function loadSuperAdminPreferences() {
        const fallbackTheme = localStorage.getItem('theme') === 'light' ? 'light' : 'dark';
        const defaults = {
            theme: fallbackTheme,
            defaultTab: 'restaurants',
            autoRefreshSec: 0
        };

        try {
            const raw = localStorage.getItem('superAdminPreferences');
            if (!raw) return defaults;
            const parsed = JSON.parse(raw);
            return {
                theme: parsed?.theme === 'light' ? 'light' : 'dark',
                defaultTab: typeof parsed?.defaultTab === 'string' ? parsed.defaultTab : defaults.defaultTab,
                autoRefreshSec: Number.isFinite(Number(parsed?.autoRefreshSec)) ? Number(parsed.autoRefreshSec) : defaults.autoRefreshSec
            };
        } catch (e) {
            return defaults;
        }
    }

    function persistSuperAdminPreferences(prefs) {
        localStorage.setItem('superAdminPreferences', JSON.stringify(prefs));
    }

    function setThemePreference(theme) {
        const normalized = theme === 'light' ? 'light' : 'dark';
        if (normalized === 'light') {
            document.body.classList.add('light-mode');
        } else {
            document.body.classList.remove('light-mode');
        }
        localStorage.setItem('theme', normalized);
        updateThemeUI();
    }

    function startAutoRefresh(seconds) {
        if (superAdminAutoRefreshInterval) {
            clearInterval(superAdminAutoRefreshInterval);
            superAdminAutoRefreshInterval = null;
        }

        const sec = Number(seconds);
        if (!sec || sec <= 0) return;

        superAdminAutoRefreshInterval = setInterval(() => {
            refreshSuperAdminStats();
        }, sec * 1000);
    }

    function applySuperAdminPreferences(prefs, options = { applyDefaultTab: true }) {
        if (!prefs) return;

        setThemePreference(prefs.theme);
        startAutoRefresh(prefs.autoRefreshSec);

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
        if (options.applyDefaultTab) {
            const allowedTabs = new Set(['restaurants', 'hosting', 'stats', 'shipping', 'settings']);
            const targetTab = allowedTabs.has(prefs.defaultTab) ? prefs.defaultTab : 'restaurants';
            const navItem = document.querySelector(`.nav-item[data-tab="${targetTab}"]`);
            if (navItem) navItem.click();
        }
    }

    function saveSuperAdminPreferences() {
        const themeSelect = document.getElementById('sa-setting-theme');
        const defaultTabSelect = document.getElementById('sa-setting-default-tab');
        const autoRefreshSelect = document.getElementById('sa-setting-auto-refresh');

        const prefs = {
            theme: themeSelect?.value === 'light' ? 'light' : 'dark',
            defaultTab: defaultTabSelect?.value || 'restaurants',
            autoRefreshSec: Number(autoRefreshSelect?.value || 0)
        };

        persistSuperAdminPreferences(prefs);
        applySuperAdminPreferences(prefs, { applyDefaultTab: false });
        showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
    }

    function resetSuperAdminPreferences() {
        const ok = confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŸ');
        if (!ok) return;

        localStorage.removeItem('superAdminPreferences');
        const defaults = loadSuperAdminPreferences();
        applySuperAdminPreferences(defaults, { applyDefaultTab: false });
        renderSuperAdminSettingsSection();
        showToast('ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
    }

    async function refreshSuperAdminStats() {
        try {
            await loadDataFromFirebase();
            loadRestaurants();
            updateStats();
            renderSuperAdminStatsSection();
            renderSuperAdminSettingsSection();
            showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        } catch (error) {
            console.error('Error refreshing stats:', error);
            showToast('ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
        }
    }

    async function initializeDefaultDataFromSettings() {
        const ok = confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ Ù‚Ø¯ ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø¯Ø¦ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù….');
        if (!ok) return;

        try {
            await FirebaseDB.initializeDefaultData();
            await refreshSuperAdminStats();
            showToast('ØªÙ…Øª ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
        } catch (error) {
            console.error('Error initializing default data:', error);
            showToast('ÙØ´Ù„ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
        }
    }

    function clearSuperAdminSession() {
        const ok = confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù„Ø³Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ØŸ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬.');
        if (!ok) return;

        localStorage.removeItem('superAdminLoggedIn');
        localStorage.removeItem('currentAdmin');
        window.location.href = 'login.html';
    }
    
    // ========== Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø³ØªØ¶Ø§ÙØ© ==========
    // hostingSites ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§ Ù…Ù† Firebase ÙÙŠ loadDataFromFirebase()
    
    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
            const tab = this.dataset.tab;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
            
            // Ø¹Ù†Ø§ØµØ± Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ø§Ø¹Ù… (Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ main-content)
            const mainContent = document.querySelector('.main-content');
            const restaurantsTopStatsGrid = mainContent.querySelector(':scope > .stats-grid');
            const restaurantsSectionHeader = mainContent.querySelector(':scope > .section-header');
            const restaurantsGrid = document.getElementById('restaurants-grid');
            const hostingSection = document.getElementById('hosting-section');
            const templatesSection = document.getElementById('templates-section');
            const shippingSection = document.getElementById('shipping-section');
            const projectsSection = document.getElementById('projects-section');
            const statsSection = document.getElementById('stats-section');
            const settingsSection = document.getElementById('settings-section');

            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹
            if (restaurantsTopStatsGrid) restaurantsTopStatsGrid.style.display = 'none';
            if (restaurantsSectionHeader) restaurantsSectionHeader.style.display = 'none';
            if (restaurantsGrid) restaurantsGrid.style.display = 'none';
            if (hostingSection) hostingSection.style.display = 'none';
            if (templatesSection) templatesSection.style.display = 'none';
            if (shippingSection) shippingSection.style.display = 'none';
            if (projectsSection) projectsSection.style.display = 'none';
            if (statsSection) statsSection.style.display = 'none';
            if (settingsSection) settingsSection.style.display = 'none';

            if (tab === 'restaurants') {
                if (restaurantsTopStatsGrid) restaurantsTopStatsGrid.style.display = '';
                if (restaurantsSectionHeader) restaurantsSectionHeader.style.display = '';
                if (restaurantsGrid) restaurantsGrid.style.display = '';
            } else if (tab === 'hosting') {
                if (hostingSection) hostingSection.style.display = 'block';
                loadHostingSites();
            } else if (tab === 'templates') {
                if (templatesSection) templatesSection.style.display = 'block';
                loadTemplatesGrid();
            } else if (tab === 'shipping') {
                if (shippingSection) shippingSection.style.display = 'block';
                loadShippingCompanies();
            } else if (tab === 'projects') {
                if (projectsSection) projectsSection.style.display = 'block';
                // ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ù„Ø¶Ù…Ø§Ù† ØªÙ‡ÙŠØ¦Ø© Firebase
                setTimeout(() => {
                    loadProjects();
                }, 100);
            } else if (tab === 'stats') {
                if (statsSection) statsSection.style.display = 'block';
                renderSuperAdminStatsSection();
            } else if (tab === 'settings') {
                if (settingsSection) settingsSection.style.display = 'block';
                renderSuperAdminSettingsSection();
            }
        });
    });
    
    function loadHostingSites() {
        const container = document.getElementById('hosting-grid');
        
        if (hostingSites.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-globe"></i>
                    <h4>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø³ØªØ¶Ø§ÙØ©</h4>
                    <p>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹" Ù„Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹ Ø¬Ø¯ÙŠØ¯</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = hostingSites.map(site => {
            const siteUrl = `https://${site.siteId}.web.app`;
            const linkedRestaurant = site.restaurantId ? restaurants.find(r => r.id === site.restaurantId) : null;

            const isDisabled = site.status === 'disabled' || site.status === 'inactive' || site.disabled === true;
            const statusClass = isDisabled ? 'disabled' : 'active';
            const statusText = isDisabled ? 'â›” Ù…ÙˆÙ‚ÙˆÙ' : 'âœ“ Ù†Ø´Ø·';
            const stopBtnClass = `stop-btn ${isDisabled ? 'enable' : ''}`;
            const stopBtnIcon = isDisabled ? 'fas fa-play' : 'fas fa-power-off';
            const stopBtnText = isDisabled ? 'ØªØ´ØºÙŠÙ„' : 'Ø¥ÙŠÙ‚Ø§Ù';
            
            return `
                <div class="hosting-card">
                    <div class="hosting-card-header">
                        <div class="hosting-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="hosting-info">
                            <h4>${site.displayName || site.siteId}</h4>
                            <p>${site.notes || 'Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</p>
                        </div>
                        <span class="hosting-status ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div class="hosting-url-box">
                        <div class="hosting-url-label">
                            <i class="fas fa-link"></i> Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹
                        </div>
                        <div class="hosting-url">
                            <a href="${siteUrl}" target="_blank">${siteUrl}</a>
                            <button onclick="copyHostingUrl('${siteUrl}')">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="hosting-restaurant ${linkedRestaurant ? '' : 'unlinked'}">
                        <i class="fas ${linkedRestaurant ? 'fa-store' : 'fa-exclamation-triangle'}"></i>
                        <span>${linkedRestaurant ? 'Ù…Ø±ØªØ¨Ø· Ø¨Ù€: ' + linkedRestaurant.name : 'ØºÙŠØ± Ù…Ø±ØªØ¨Ø· Ø¨Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ'}</span>
                        ${!linkedRestaurant ? `<button onclick='editHostingSite(${JSON.stringify(site.siteId)})' style="background: var(--warning); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">Ø±Ø¨Ø·</button>` : ''}
                    </div>
                    
                    <div class="hosting-template-info" style="padding: 10px; margin: 10px 0; background: rgba(99, 102, 241, 0.1); border-radius: 8px; border: 1px solid rgba(99, 102, 241, 0.2); display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px;">
                        <div>
                            <i class="fas fa-palette" style="color: var(--primary);"></i>
                            <span style="margin-right: 8px;">${site.deployedTemplate ? 'Ø§Ù„Ù‚Ø§Ù„Ø¨: <strong>' + (site.deployedTemplateName || site.deployedTemplate) + '</strong>' : '<span style="color: var(--text-secondary);">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ø¹Ø¯</span>'}</span>
                            ${site.lastDeployedAt ? `<span style="font-size: 0.8rem; color: var(--text-secondary); margin-right: 10px;">Ø¢Ø®Ø± Ù†Ø´Ø±: ${new Date(site.lastDeployedAt).toLocaleString('ar-SA')}</span>` : ''}
                        </div>
                        <button onclick="selectDeployedTemplate('${site.siteId}')" style="background: transparent; border: 1px solid var(--primary); color: var(--primary); padding: 4px 10px; border-radius: 5px; cursor: pointer; font-size: 0.75rem;">
                            <i class="fas fa-edit"></i> ØªØ­Ø¯ÙŠØ«
                        </button>
                    </div>
                    
                    <div class="hosting-actions">
                        <button class="visit-btn" ${isDisabled ? 'disabled' : `onclick="window.open('${siteUrl}', '_blank')"`}>
                            <i class="fas fa-external-link-alt"></i>
                            ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹
                        </button>
                        <button class="deploy-btn" ${isDisabled ? 'disabled' : `onclick="showDeployInstructions('${site.siteId}')"`}>
                            <i class="fas fa-upload"></i>
                            Ù†Ø´Ø±
                        </button>
                        <button class="${stopBtnClass}" onclick="toggleHostingSiteStatus('${site.siteId}', ${isDisabled ? 'true' : 'false'})">
                            <i class="${stopBtnIcon}"></i>
                            ${stopBtnText}
                        </button>
                        <button class="delete-btn" onclick="deleteHostingSite('${site.siteId}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
        }).join('');
    }

    async function toggleHostingSiteStatus(siteId, isCurrentlyDisabled) {
        if (!siteId) {
            showToast('Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
            return;
        }

        if (siteId === 'restaurant-system-demo') {
            showToast('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'error');
            return;
        }

        const confirmText = isCurrentlyDisabled
            ? `Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŸ\n\n${siteId}`
            : `Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ\n\nÙ„Ù† ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø­ØªÙ‰ ÙŠØªÙ… ØªØ´ØºÙŠÙ„Ù‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.\n\n${siteId}`;

        if (!confirm(confirmText)) return;

        try {
            if (!window.FirebaseDB || typeof FirebaseDB.updateSite !== 'function') {
                showToast('Ù…ÙŠØ²Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹. Ø­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø© (Ctrl+F5).', 'error');
                return;
            }

            const newStatus = isCurrentlyDisabled ? 'active' : 'disabled';
            await FirebaseDB.updateSite(siteId, {
                status: newStatus,
                updatedAt: new Date().toISOString()
            });

            // ØªØ­Ø¯ÙŠØ« Ù…Ø­Ù„ÙŠ Ø³Ø±ÙŠØ¹ Ù„Ù„ÙˆØ§Ø¬Ù‡Ø© Ø­ØªÙ‰ Ù„Ùˆ ÙØ´Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            const idx = hostingSites.findIndex(s => s.siteId === siteId);
            if (idx !== -1) {
                hostingSites[idx] = { ...hostingSites[idx], status: newStatus };
            }
            loadHostingSites();

            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
            try {
                await loadDataFromFirebase();
                loadHostingSites();
            } catch (e) {
                // ØªØ¬Ø§Ù‡Ù„
            }

            showToast(isCurrentlyDisabled ? 'ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ âœ…' : 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ â›”');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹:', error);
            const msg = (error && (error.message || error.code)) ? (error.message || error.code) : 'ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹';
            showToast(msg, 'error');
        }
    }
    
    function copyHostingUrl(url) {
        navigator.clipboard.writeText(url).then(() => {
            showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·');
        });
    }
    
    function openHostingModal(id = null) {
        document.getElementById('hosting-modal-overlay').classList.add('active');
        document.getElementById('hosting-modal-title').textContent = id ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹' : 'Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹ Ù…Ø³ØªØ¶Ø§Ù';
        
        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
        const select = document.getElementById('h-restaurant');
        select.innerHTML = '<option value="">-- Ø¨Ø¯ÙˆÙ† Ø±Ø¨Ø· --</option>' + 
            restaurants.map(r => `<option value="${r.id}">${r.name}</option>`).join('');

        // Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù„Ù…Ø¹Ø±ÙØ§Øª Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (Ù…Ù† Firebase DB + Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¹Ù†Ø¯ ØªÙˆÙØ±Ù‡)
        populateHostingSiteIdSuggestions();
        
        const siteIdInput = document.getElementById('h-site-id');
        if (id) {
            const site = hostingSites.find(s => s.siteId === id || s.id === id);
            if (site) {
                document.getElementById('hosting-edit-id').value = site.siteId;
                siteIdInput.value = site.siteId;
                siteIdInput.disabled = true;
                document.getElementById('h-display-name').value = site.displayName || site.name || '';
                document.getElementById('h-restaurant').value = site.restaurantId || '';
                document.getElementById('h-notes').value = site.notes || '';
            }
        } else {
            document.getElementById('hosting-form').reset();
            document.getElementById('hosting-edit-id').value = '';
            siteIdInput.disabled = false;
        }
    }

    function populateHostingSiteIdSuggestions() {
        const list = document.getElementById('hosting-site-id-list');
        if (!list) return;

        const seen = new Set();
        const addOption = (value) => {
            const v = (value || '').toString().trim();
            if (!v || seen.has(v)) return;
            seen.add(v);
            const opt = document.createElement('option');
            opt.value = v;
            list.appendChild(opt);
        };

        // 1) Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙÙŠ Firebase DB (metadata)
        list.innerHTML = '';
        (hostingSites || []).forEach(s => addOption(s.siteId));

        // 2) Ù…Ù† Firebase Hosting Ø¹Ø¨Ø± Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
        const projectId = (typeof firebaseConfig !== 'undefined' && firebaseConfig && firebaseConfig.projectId)
            ? firebaseConfig.projectId
            : null;
        const url = projectId
            ? `http://localhost:8080/api/hosting/sites?project=${encodeURIComponent(projectId)}`
            : 'http://localhost:8080/api/hosting/sites';

        fetch(url)
            .then(r => r.ok ? r.json() : null)
            .then(data => {
                if (!data || !data.success || !Array.isArray(data.sites)) return;
                data.sites.forEach(addOption);
            })
            .catch(() => {
                // ØªØ¬Ø§Ù‡Ù„ - Ù‚Ø¯ Ù„Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ ÙŠØ¹Ù…Ù„ Ø£Ùˆ Ù‚Ø¯ ØªÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ù‚ÙŠÙˆØ¯ Mixed Content
            });
    }
    
    function closeHostingModal() {
        document.getElementById('hosting-modal-overlay').classList.remove('active');
    }
    
    function editHostingSite(siteId) {
        openHostingModal(siteId);
    }
    
    function saveHostingSite() {
        const editSiteId = document.getElementById('hosting-edit-id').value;
        const siteId = document.getElementById('h-site-id').value.trim();
        
        if (!siteId) {
            showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
            return;
        }
        
        const data = {
            // Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù†ÙØ³ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù…Ù‡Ø§ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            displayName: document.getElementById('h-display-name').value.trim(),
            restaurantId: document.getElementById('h-restaurant').value || null,
            notes: document.getElementById('h-notes').value.trim(),
            updatedAt: new Date().toISOString()
        };

        // Ù…Ù†Ø¹ ØªØºÙŠÙŠØ± siteId Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        if (editSiteId && editSiteId !== siteId) {
            showToast('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„', 'error');
            return;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
        if (!editSiteId && hostingSites.some(s => s.siteId === siteId)) {
            showToast('Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'error');
            return;
        }

        (async () => {
            try {
                if (!window.FirebaseDB || typeof FirebaseDB.saveSite !== 'function') {
                    showToast('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹', 'error');
                    return;
                }

                // Ø­ÙØ¸ Ø¹Ù„Ù‰ Firebase (metadata ÙÙ‚Ø·)
                if (editSiteId) {
                    await FirebaseDB.updateSite(siteId, data);
                } else {
                    await FirebaseDB.saveSite(siteId, {
                        ...data,
                        status: 'active',
                        createdAt: new Date().toISOString()
                    });
                }

                await loadDataFromFirebase();
                loadHostingSites();
                closeHostingModal();
                showToast(editSiteId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹');
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹:', error);
                showToast(error?.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
            }
        })();
    }
    
    async function deleteHostingSite(siteId) {
        const site = hostingSites.find(s => s.siteId === siteId);
        if (siteId === 'restaurant-system-demo') {
            showToast('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'error');
            return;
        }

        const confirmText = `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙ‚Ø· (ÙˆÙ„ÙŠØ³ Ù…Ù† Firebase Hosting).\n\n${siteId}`;
        if (!confirm(confirmText)) return;

        try {
            if (!window.FirebaseDB || typeof FirebaseDB.deleteSite !== 'function') {
                showToast('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹', 'error');
                return;
            }

            await FirebaseDB.deleteSite(siteId);

            // ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø­Ø°Ù ØªÙ… ÙØ¹Ù„Ø§Ù‹ (Ù„ØªØ´Ø®ÙŠØµ Ù…Ø´Ø±ÙˆØ¹/ÙƒØ§Ø´ Ù…Ø®ØªÙ„Ù)
            try {
                const sitesAfter = await FirebaseDB.getSites();
                if (sitesAfter && Object.prototype.hasOwnProperty.call(sitesAfter, siteId)) {
                    showToast('ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ø°Ù Ù„ÙƒÙ† Ù…Ø§ Ø²Ø§Ù„ ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ø¹Ù„Ù‰ Ù†ÙØ³ Ù…Ø´Ø±ÙˆØ¹ Firebase ÙˆØ­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø© (Ctrl+F5).', 'error');
                }
            } catch (e) {
                // ØªØ¬Ø§Ù‡Ù„
            }

            await loadDataFromFirebase();
            loadHostingSites();
            showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹:', error);
            showToast(error?.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
        }
    }
    
    function showDeployInstructions(siteId) {
        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø«Ù… Ø§Ù„Ù†Ø´Ø±
        openDeployModal(siteId);
    }
    
    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
    let availableTemplates = [];
    let templateCategories = [];
    let selectedDeploySiteId = null;
    let selectedTemplateForDeploy = null;
    let currentCategoryFilter = 'all';
    
    // ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
    async function loadTemplatesGrid() {
        const container = document.getElementById('templates-grid');
        if (!container) {
            console.log('templates-grid container not found');
            return;
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
        try {
            const response = await fetch('/api/templates');
            const data = await response.json();
            console.log('Templates API Response:', data);
            if (data.success && data.templates) {
                availableTemplates = data.templates;
                templateCategories = data.categories || [];
                console.log('Templates loaded:', availableTemplates.length);
                console.log('Categories loaded:', templateCategories.length);
            }
        } catch (e) {
            console.error('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨:', e);
            availableTemplates = [];
            templateCategories = [];
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        const totalEl = document.getElementById('total-templates');
        const sitesEl = document.getElementById('total-sites-for-templates');
        if (totalEl) totalEl.textContent = availableTemplates.length;
        if (sitesEl) sitesEl.textContent = hostingSites.length;
        
        // Ø¹Ø±Ø¶ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        renderCategoryFilters();
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
        renderTemplatesWithCategories();
    }
    
    // Ø¹Ø±Ø¶ Ø£Ø²Ø±Ø§Ø± ØªØµÙÙŠØ© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    function renderCategoryFilters() {
        const filtersContainer = document.getElementById('category-filters');
        if (!filtersContainer) {
            console.log('category-filters container not found');
            return;
        }
        
        let html = `<button class="category-filter-btn ${currentCategoryFilter === 'all' ? 'active' : ''}" onclick="filterByCategory('all')" style="--cat-color: #6366f1;">
            <span>ğŸ“‹</span> Ø§Ù„ÙƒÙ„ (${availableTemplates.length})
        </button>`;
        
        if (templateCategories && templateCategories.length > 0) {
            templateCategories.forEach(cat => {
                const count = availableTemplates.filter(t => t.category === cat.id).length;
                html += `<button class="category-filter-btn ${currentCategoryFilter === cat.id ? 'active' : ''}" 
                    onclick="filterByCategory('${cat.id}')" style="--cat-color: ${cat.color};">
                    <span>${cat.icon}</span> ${cat.name} (${count})
                </button>`;
            });
        }
        
        filtersContainer.innerHTML = html;
        console.log('Category filters rendered:', templateCategories.length, 'categories');
    }
    
    // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…
    function filterByCategory(categoryId) {
        currentCategoryFilter = categoryId;
        renderCategoryFilters();
        renderTemplatesWithCategories();
    }
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ù…ØµÙ†ÙØ©
    function renderTemplatesWithCategories() {
        const container = document.getElementById('templates-grid');
        if (!container) return;
        
        let filteredTemplates = availableTemplates;
        if (currentCategoryFilter !== 'all') {
            filteredTemplates = availableTemplates.filter(t => t.category === currentCategoryFilter);
        }
        
        if (filteredTemplates.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-palette"></i>
                    <h4>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ÙˆØ§Ù„Ø¨ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</h4>
                    <p>Ø§Ø®ØªØ± Ù‚Ø³Ù…Ø§Ù‹ Ø¢Ø®Ø± Ø£Ùˆ Ø£Ø¶Ù Ù‚ÙˆØ§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯Ø©</p>
                </div>
            `;
            return;
        }
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† "Ø§Ù„ÙƒÙ„"ØŒ Ù†Ø¹Ø±Ø¶ ÙƒÙ„ Ù‚Ø³Ù… Ù…Ø¹ Ù‚ÙˆØ§Ù„Ø¨Ù‡
        if (currentCategoryFilter === 'all' && templateCategories.length > 0) {
            let html = '';
            
            templateCategories.forEach(cat => {
                const catTemplates = filteredTemplates.filter(t => t.category === cat.id);
                if (catTemplates.length > 0) {
                    html += `
                        <div class="category-section-wrapper" style="grid-column: 1 / -1; margin-bottom: 30px;">
                            <div class="category-header" style="background: linear-gradient(135deg, ${cat.color}15, ${cat.color}30); border: 1px solid ${cat.color}40; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                                <h3 style="display: flex; align-items: center; gap: 12px; margin: 0; color: ${cat.color}; font-size: 1.4rem;">
                                    <span style="font-size: 2rem;">${cat.icon}</span> 
                                    ${cat.name}
                                    <span style="background: ${cat.color}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; margin-right: auto;">${catTemplates.length} Ù‚ÙˆØ§Ù„Ø¨</span>
                                </h3>
                            </div>
                            <div class="category-templates-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                                ${catTemplates.map(template => renderTemplateCard(template)).join('')}
                            </div>
                        </div>
                    `;
                }
            });
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠÙ
            const uncategorized = filteredTemplates.filter(t => !t.category || !templateCategories.find(c => c.id === t.category));
            if (uncategorized.length > 0) {
                html += `
                    <div class="category-section-wrapper" style="grid-column: 1 / -1; margin-bottom: 30px;">
                        <div class="category-header" style="background: linear-gradient(135deg, #64748b15, #64748b30); border: 1px solid #64748b40; border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="display: flex; align-items: center; gap: 12px; margin: 0; color: #64748b; font-size: 1.4rem;">
                                <span style="font-size: 2rem;">ğŸ“</span> 
                                Ø£Ø®Ø±Ù‰
                                <span style="background: #64748b; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; margin-right: auto;">${uncategorized.length} Ù‚ÙˆØ§Ù„Ø¨</span>
                            </h3>
                        </div>
                        <div class="category-templates-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                            ${uncategorized.map(template => renderTemplateCard(template)).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html || filteredTemplates.map(template => renderTemplateCard(template)).join('');
        } else {
            // Ø¹Ø±Ø¶ Ù‚Ø³Ù… ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
            container.innerHTML = filteredTemplates.map(template => renderTemplateCard(template)).join('');
        }
    }
    
    // Ø±Ø³Ù… Ø¨Ø·Ø§Ù‚Ø© Ù‚Ø§Ù„Ø¨ ÙˆØ§Ø­Ø¯Ø©
    function renderTemplateCard(template) {
        const category = templateCategories.find(c => c.id === template.category);
        const catBadge = category ? `<span class="template-category-badge" style="background: ${category.color}20; color: ${category.color};">${category.icon} ${category.name}</span>` : '';
        
        return `
            <div class="template-grid-card">
                <div class="template-preview" style="background: linear-gradient(135deg, ${template.color}22, ${template.color}44);">
                    <span>${template.icon}</span>
                </div>
                <div class="template-content">
                    ${catBadge}
                    <div class="template-name">${template.name}</div>
                    <div class="template-desc">${template.description}</div>
                    <div class="template-actions">
                        <button class="preview-btn" onclick="previewTemplate('${template.id}')">
                            <i class="fas fa-eye"></i> Ù…Ø¹Ø§ÙŠÙ†Ø©
                        </button>
                        <button class="deploy-template-btn" onclick="openDeployTemplateModal('${template.id}')">
                            <i class="fas fa-rocket"></i> Ù†Ø´Ø± Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹
                        </button>
                    </div>
                </div>
            </div>
        `;
    }
    
    // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØ§Ø´
    async function clearAllCache() {
        if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒØ§Ø´ØŸ Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.')) {
            return;
        }
        
        showToast('Ø¬Ø§Ø±ÙŠ Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´...');
        
        try {
            // Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­
            if ('caches' in window) {
                const cacheNames = await caches.keys();
                for (const cacheName of cacheNames) {
                    await caches.delete(cacheName);
                }
            }
            
            // Ù…Ø³Ø­ localStorage
            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && (key.includes('cache') || key.includes('template') || key.includes('Cache'))) {
                    keysToRemove.push(key);
                }
            }
            keysToRemove.forEach(key => localStorage.removeItem(key));
            
            // Ù…Ø³Ø­ sessionStorage
            sessionStorage.clear();
            
            // Ø¥Ù„ØºØ§Ø¡ ØªØ³Ø¬ÙŠÙ„ Service Workers
            if ('serviceWorker' in navigator) {
                const registrations = await navigator.serviceWorker.getRegistrations();
                for (const registration of registrations) {
                    await registration.unregister();
                }
            }
            
            showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´ Ø¨Ù†Ø¬Ø§Ø­! âœ…', 'success');
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
            setTimeout(() => {
                location.reload(true);
            }, 1000);
            
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´:', error);
            showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´', 'error');
        }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
    async function refreshTemplates() {
        showToast('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨...');
        await loadTemplatesGrid();
        showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ âœ…');
    }
    
    // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨
    function previewTemplate(templateId) {
        const template = availableTemplates.find(t => t.id === templateId);
        if (template && template.preview) {
            window.open('/' + template.preview, '_blank');
        }
    }
    
    // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù†Ø´Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨
    function openDeployTemplateModal(templateId) {
        selectedTemplateForDeploy = templateId;
        const template = availableTemplates.find(t => t.id === templateId);
        
        if (hostingSites.length === 0) {
            showToast('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ù‚Ø¹ Ù…Ø³ØªØ¶Ø§ÙØ©. Ø£Ø¶Ù Ù…ÙˆÙ‚Ø¹ Ø£ÙˆÙ„Ø§Ù‹.', 'error');
            return;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹
        const sitesHtml = hostingSites.map(site => `
            <div class="template-card" data-site="${site.siteId}" onclick="selectSiteForTemplate('${site.siteId}')">
                <div class="template-icon" style="background: linear-gradient(135deg, #f97316, #ea580c);">
                    <i class="fas fa-fire"></i>
                </div>
                <div class="template-info">
                    <h4>${site.displayName || site.siteId}</h4>
                    <p>https://${site.siteId}.web.app</p>
                </div>
                <div class="template-check"><i class="fas fa-check-circle"></i></div>
            </div>
        `).join('');
        
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… deploy-modal Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„Ù‡
        const modal = document.getElementById('deploy-modal-overlay');
        if (modal) {
            document.getElementById('deploy-site-name').textContent = template ? template.name : templateId;
            document.getElementById('templates-list').innerHTML = sitesHtml;
            document.querySelector('#deploy-modal-overlay .modal-header h3').innerHTML = 
                `<i class="fas fa-globe"></i> Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù†Ø´Ø± "${template ? template.name : templateId}"`;
            modal.classList.add('active');
        }
    }
    
    // Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆÙ‚Ø¹ Ù„Ù„Ù†Ø´Ø±
    function selectSiteForTemplate(siteId) {
        selectedDeploySiteId = siteId;
        document.querySelectorAll('#templates-list .template-card').forEach(card => {
            card.classList.remove('selected');
            if (card.dataset.site === siteId) {
                card.classList.add('selected');
            }
        });
    }
    
    // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù„Ù„Ù†Ø´Ø±
    async function openDeployModal(siteId) {
        selectedDeploySiteId = siteId;
        selectedTemplateForDeploy = null;
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
        try {
            const response = await fetch('/api/templates');
            const data = await response.json();
            if (data.success && data.templates) {
                availableTemplates = data.templates;
            }
        } catch (e) {
            console.log('ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©');
            availableTemplates = [];
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø©
        const modal = document.getElementById('deploy-modal-overlay');
        if (modal) {
            document.getElementById('deploy-site-name').textContent = siteId;
            document.querySelector('#deploy-modal-overlay .modal-header h3').innerHTML = 
                `<i class="fas fa-rocket"></i> Ù†Ø´Ø± Ø¹Ù„Ù‰ <span id="deploy-site-name">${siteId}</span>`;
            renderTemplatesList();
            modal.classList.add('active');
        } else {
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ù†Ø´Ø± Ù…Ø¨Ø§Ø´Ø±
            deployToFirebase(siteId);
        }
    }
    
    function closeDeployModal() {
        const modal = document.getElementById('deploy-modal-overlay');
        if (modal) modal.classList.remove('active');
        selectedDeploySiteId = null;
        selectedTemplateForDeploy = null;
    }
    
    function renderTemplatesList() {
        const container = document.getElementById('templates-list');
        if (!container) return;
        
        let html = `
            <div class="template-card selected" data-template="current" onclick="selectTemplate('current')">
                <div class="template-icon" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">ğŸ“</div>
                <div class="template-info">
                    <h4>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                    <p>Ù†Ø´Ø± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±</p>
                </div>
                <div class="template-check"><i class="fas fa-check-circle"></i></div>
            </div>
        `;
        
        availableTemplates.forEach(t => {
            html += `
                <div class="template-card" data-template="${t.id}" onclick="selectTemplate('${t.id}')">
                    <div class="template-icon" style="background: linear-gradient(135deg, ${t.color}, ${t.color}dd);">${t.icon}</div>
                    <div class="template-info">
                        <h4>${t.name}</h4>
                        <p>${t.description}</p>
                    </div>
                    <div class="template-check"><i class="fas fa-check-circle"></i></div>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    function selectTemplate(templateId) {
        document.querySelectorAll('.template-card').forEach(card => {
            card.classList.remove('selected');
            if (card.dataset.template === templateId) {
                card.classList.add('selected');
            }
        });
    }
    
    function getSelectedTemplate() {
        const selected = document.querySelector('.template-card.selected');
        return selected ? (selected.dataset.template || selected.dataset.site) : 'current';
    }
    
    async function confirmDeploy() {
        let templateId, siteId;
        
        if (selectedTemplateForDeploy) {
            // ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø§Ù„Ø¨ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ - Ù†Ø±ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø®ØªØ§Ø±
            templateId = selectedTemplateForDeploy;
            siteId = selectedDeploySiteId;
            
            if (!siteId) {
                showToast('Ø§Ø®ØªØ± Ù…ÙˆÙ‚Ø¹Ø§Ù‹ Ù„Ù„Ù†Ø´Ø± Ø¹Ù„ÙŠÙ‡', 'error');
                return;
            }
        } else {
            // ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆÙ‚Ø¹ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ - Ù†Ø±ÙŠØ¯ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ø®ØªØ§Ø±
            templateId = getSelectedTemplate();
            siteId = selectedDeploySiteId;
        }
        
        closeDeployModal();
        deployToFirebase(siteId, templateId);
    }
    
    async function deployToFirebase(siteId, templateId = 'current') {
        const templateName = templateId === 'current' ? 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©' : availableTemplates.find(t => t.id === templateId)?.name || templateId;
        const confirmDeploy = confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ù†Ø´Ø± "${templateName}" Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ "${siteId}"ØŸ\n\nÙ…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 8080`);
        if (!confirmDeploy) return;
        
        showToast('Ø¬Ø§Ø±ÙŠ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø´Ø±...', 'success');
        
        try {
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ
            const response = await fetch('http://localhost:8080/api/deploy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ siteId: siteId, templateId: templateId })
            });
            
            if (!response.ok) throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„');
            
            const result = await response.json();
            
            if (result.success) {
                showToast(`Ø¨Ø¯Ø£ Ù†Ø´Ø± ${templateName}... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±`, 'success');
                // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø±
                checkDeployStatus(siteId, templateId, templateName);
            } else {
                showToast(result.error || 'ÙØ´Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø´Ø±', 'error');
            }
            
        } catch (error) {
            // Ø§Ù„Ø³ÙŠØ±ÙØ± ØºÙŠØ± Ù…ØªØ§Ø­ØŒ Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
            showManualDeployInstructions(siteId);
        }
    }
    
    async function checkDeployStatus(siteId, templateId = null, templateName = null) {
        let attempts = 0;
        const maxAttempts = 60; // Ø£Ù‚ØµÙ‰ 60 Ù…Ø­Ø§ÙˆÙ„Ø© (Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†)
        
        const checkInterval = setInterval(async () => {
            attempts++;
            
            try {
                const response = await fetch('http://localhost:8080/api/deploy/status');
                const status = await response.json();
                
                if (!status.running) {
                    clearInterval(checkInterval);
                    
                    if (status.success) {
                        showToast(`âœ… ØªÙ… Ù†Ø´Ø± ${siteId} Ø¨Ù†Ø¬Ø§Ø­!`, 'success');
                        
                        // Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
                        await updateSiteDeployInfo(siteId, status.templateId || templateId, templateName);
                        
                        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ Ù…ÙØµÙ„Ø©
                        setTimeout(() => {
                            alert(`ğŸ‰ ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­!\n\nØ§Ù„Ø±Ø§Ø¨Ø·: https://${siteId}.web.app\n\nÙŠÙ…ÙƒÙ†Ùƒ ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¢Ù†.`);
                        }, 500);
                    } else {
                        showToast('âŒ ÙØ´Ù„ Ø§Ù„Ù†Ø´Ø±', 'error');
                        console.error('Deploy output:', status.output);
                        alert('ÙØ´Ù„ Ø§Ù„Ù†Ø´Ø±:\n\n' + status.output);
                    }
                }
            } catch (e) {
                // ØªØ¬Ø§Ù‡Ù„ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„
            }
            
            if (attempts >= maxAttempts) {
                clearInterval(checkInterval);
                showToast('Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù†Ø´Ø±', 'error');
            }
        }, 2000);
    }
    
    // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø± Ù„Ù„Ù…ÙˆÙ‚Ø¹
    async function updateSiteDeployInfo(siteId, templateId, templateName) {
        console.log('ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø±:', { siteId, templateId, templateName });
        try {
            const updateData = {
                deployedTemplate: templateId || 'current',
                deployedTemplateName: templateName || (templateId === 'current' ? 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©' : templateId),
                lastDeployedAt: new Date().toISOString()
            };
            
            console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«:', updateData);
            
            // ØªØ­Ø¯ÙŠØ« ÙÙŠ Firebase
            if (window.FirebaseDB && typeof FirebaseDB.updateSite === 'function') {
                await FirebaseDB.updateSite(siteId, updateData);
                console.log('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙÙŠ Firebase Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                console.warn('FirebaseDB.updateSite ØºÙŠØ± Ù…ØªØ§Ø­');
            }
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø­Ù„ÙŠ
            const idx = hostingSites.findIndex(s => s.siteId === siteId);
            if (idx !== -1) {
                hostingSites[idx] = { ...hostingSites[idx], ...updateData };
                console.log('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ù„ÙŠ:', hostingSites[idx]);
            }
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶
            loadHostingSites();
            
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø±:', error);
        }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø± Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø°ÙŠ Ù†ÙØ´Ø± Ø³Ø§Ø¨Ù‚Ø§Ù‹ (ÙŠØ¯ÙˆÙŠØ§Ù‹)
    window.updateDeployedTemplate = async function(siteId, templateId, templateName) {
        await updateSiteDeployInfo(siteId, templateId, templateName);
        showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨', 'success');
    };
    
    // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ù„Ù„Ù…ÙˆÙ‚Ø¹
    async function selectDeployedTemplate(siteId) {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ø­Ù…Ù„Ø©
        if (!availableTemplates || availableTemplates.length === 0) {
            try {
                const response = await fetch('/api/templates');
                const data = await response.json();
                if (data.success && data.templates) {
                    availableTemplates = data.templates;
                }
            } catch (e) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨:', e);
            }
        }
        
        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ù…ØªØ§Ø­Ø©
        let templateOptions = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ù„Ø¨ --</option>';
        availableTemplates.forEach(t => {
            templateOptions += `<option value="${t.id}">${t.name}</option>`;
        });
        
        const modalHtml = `
            <div id="select-template-modal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); display: flex; justify-content: center; align-items: center; z-index: 10000;">
                <div style="background: #1a1a2e; padding: 25px; border-radius: 15px; max-width: 400px; width: 90%; border: 1px solid rgba(99, 102, 241, 0.3);">
                    <h3 style="margin-bottom: 15px; color: #fff;">
                        <i class="fas fa-palette" style="color: #6366f1;"></i> ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
                    </h3>
                    <p style="color: #a0aec0; margin-bottom: 15px;">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø°ÙŠ ØªÙ… Ù†Ø´Ø±Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹: <strong style="color: #6366f1;">${siteId}</strong></p>
                    <select id="template-select" style="width: 100%; padding: 12px; border-radius: 8px; background: #0f0f1a; color: #fff; border: 1px solid #333; margin-bottom: 15px; font-size: 14px;">
                        ${templateOptions}
                    </select>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="confirmTemplateSelection('${siteId}')" style="flex: 1; padding: 12px; background: #6366f1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            <i class="fas fa-check"></i> ØªØ£ÙƒÙŠØ¯
                        </button>
                        <button onclick="document.getElementById('select-template-modal').remove()" style="flex: 1; padding: 12px; background: #2d2d44; color: #fff; border: 1px solid #444; border-radius: 8px; cursor: pointer;">
                            Ø¥Ù„ØºØ§Ø¡
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modalHtml);
    }
    
    // ØªØ£ÙƒÙŠØ¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨
    async function confirmTemplateSelection(siteId) {
        const select = document.getElementById('template-select');
        const templateId = select.value;
        
        if (!templateId) {
            showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø§Ù„Ø¨', 'error');
            return;
        }
        
        const template = availableTemplates.find(t => t.id === templateId);
        const templateName = template ? template.name : templateId;
        
        document.getElementById('select-template-modal').remove();
        
        await updateSiteDeployInfo(siteId, templateId, templateName);
        showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }
    
    function showManualDeployInstructions(siteId) {
        const instructions = `âš ï¸ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ ØºÙŠØ± Ù…ØªØ§Ø­!

Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙˆØ§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:
1. Ø§ÙØªØ­ Terminal
2. Ø§Ù†ØªÙ‚Ù„ Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
3. Ø´ØºÙ‘Ù„: python3 server.py
4. Ø«Ù… Ø§Ø¶ØºØ· "Ù†Ø´Ø±" Ù…Ø±Ø© Ø£Ø®Ø±Ù‰

Ø£Ùˆ Ù„Ù„Ù†Ø´Ø± ÙŠØ¯ÙˆÙŠØ§Ù‹:
firebase deploy${siteId !== 'restaurant-system-demo' ? ' --only hosting:' + siteId : ''}`;
        
        alert(instructions);
    }
    
    async function deployAllSites() {
        const confirmDeploy = confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù†Ø´Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ØŸ\n\nÙ…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ø­Ù„ÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 8080');
        if (!confirmDeploy) return;
        
        showToast('Ø¬Ø§Ø±ÙŠ Ù†Ø´Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹...', 'success');
        
        try {
            const response = await fetch('http://localhost:8080/api/deploy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ siteId: null }) // Ù†Ø´Ø± Ø§Ù„ÙƒÙ„
            });
            
            if (!response.ok) throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„');
            
            const result = await response.json();
            
            if (result.success) {
                showToast('Ø¨Ø¯Ø£ Ù†Ø´Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹...', 'success');
                checkDeployStatus('restaurant-system-demo');
            } else {
                showToast(result.error || 'ÙØ´Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø´Ø±', 'error');
            }
            
        } catch (error) {
            showManualDeployInstructions('restaurant-system-demo');
        }
    }

    // ============= Ø¥Ø¯Ø§Ø±Ø© Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† =============
    
    let shippingCompanies = [];
    let editingShippingId = null;
    let currentGeneratedApiKey = null;
    
    // ØªÙˆÙ„ÙŠØ¯ API Key ÙØ±ÙŠØ¯
    function generateApiKey() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        const prefix = 'SHP_';
        let key = prefix;
        for (let i = 0; i < 32; i++) {
            key += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        // Ø¥Ø¶Ø§ÙØ© timestamp Ù„Ù„ØªÙØ±Ø¯
        key += '_' + Date.now().toString(36).toUpperCase();
        return key;
    }
    
    // Ù†Ø³Ø® API Key
    function copyApiKey() {
        const apiKeyInput = document.getElementById('s-generated-api-key');
        apiKeyInput.select();
        document.execCommand('copy');
        showToast('ØªÙ… Ù†Ø³Ø® Ù…ÙØªØ§Ø­ API! ğŸ“‹', 'success');
    }
    
    // ØªÙˆÙ„ÙŠØ¯ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯
    function regenerateApiKey() {
        if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙˆÙ„ÙŠØ¯ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯ØŸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø³ÙŠØµØ¨Ø­ ØºÙŠØ± ØµØ§Ù„Ø­!')) {
            currentGeneratedApiKey = generateApiKey();
            document.getElementById('s-generated-api-key').value = currentGeneratedApiKey;
            showToast('ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯!', 'success');
        }
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†
    async function loadShippingCompanies() {
        const container = document.getElementById('shipping-grid');
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ±
        if (!container) {
            console.log('shipping-grid not found, skipping load');
            return;
        }
        
        try {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Firebase
            if (typeof database === 'undefined') {
                console.error('Firebase database not initialized');
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ef4444; grid-column: 1/-1;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                        <p>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
                    </div>
                `;
                return;
            }
            
            const snapshot = await database.ref('restaurant-system/shippingCompanies').once('value');
            const data = snapshot.val() || {};
            shippingCompanies = Object.entries(data).map(([id, company]) => ({
                id,
                ...company
            }));
            console.log('Loaded shipping companies:', shippingCompanies.length);
            renderShippingCompanies();
            updateShippingStats();
        } catch (error) {
            console.error('Error loading shipping companies:', error);
            if (container) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #f59e0b; grid-column: 1/-1;">
                        <i class="fas fa-exclamation-circle" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                        <p>Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†</p>
                        <button onclick="loadShippingCompanies()" style="margin-top: 10px; background: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">
                            <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                        </button>
                    </div>
                `;
            }
        }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø­Ù†
    function updateShippingStats() {
        const total = shippingCompanies.length;
        const active = shippingCompanies.filter(c => c.status === 'active').length;
        const withApi = shippingCompanies.filter(c => c.apiKey).length;
        
        const totalEl = document.getElementById('total-shipping-companies');
        const activeEl = document.getElementById('active-apis');
        const shipmentsEl = document.getElementById('total-shipments');
        const revenueEl = document.getElementById('shipping-revenue');
        
        if (totalEl) totalEl.textContent = total;
        if (activeEl) activeEl.textContent = withApi;
        if (shipmentsEl) shipmentsEl.textContent = '0';
        if (revenueEl) revenueEl.textContent = '0';
    }
    
    // Ø¹Ø±Ø¶ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù†
    function renderShippingCompanies() {
        const container = document.getElementById('shipping-grid');
        
        if (shippingCompanies.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 60px 20px; color: #666; grid-column: 1/-1;">
                    <i class="fas fa-truck" style="font-size: 4rem; color: #ddd; margin-bottom: 20px; display: block;"></i>
                    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±ÙƒØ§Øª Ø´Ø­Ù†</h3>
                    <p>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø´Ø­Ù†" Ù„Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = shippingCompanies.map(company => `
            <div class="shipping-card" style="
                background: white;
                border-radius: 15px;
                padding: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.08);
                border-right: 4px solid ${company.status === 'active' ? '#10b981' : company.status === 'testing' ? '#f59e0b' : '#ef4444'};
            ">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        ${company.logo ? `<img src="${company.logo}" style="width: 45px; height: 45px; border-radius: 10px; object-fit: cover;">` : 
                        `<div style="width: 45px; height: 45px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-truck" style="color: white;"></i>
                        </div>`}
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.1rem;">${company.name}</h3>
                            <span style="
                                background: ${company.status === 'active' ? '#d1fae5' : company.status === 'testing' ? '#fef3c7' : '#fee2e2'};
                                color: ${company.status === 'active' ? '#065f46' : company.status === 'testing' ? '#92400e' : '#991b1b'};
                                padding: 3px 10px;
                                border-radius: 12px;
                                font-size: 0.75rem;
                            ">${company.status === 'active' ? 'ğŸŸ¢ Ù†Ø´Ø·' : company.status === 'testing' ? 'ğŸŸ¡ ØªØ¬Ø±ÙŠØ¨ÙŠ' : 'ğŸ”´ Ù…ØªÙˆÙ‚Ù'}</span>
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button onclick="viewApiKey('${company.id}')" title="Ø¹Ø±Ø¶ API Key" style="
                            background: #8b5cf6;
                            color: white;
                            border: none;
                            width: 32px;
                            height: 32px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 0.85rem;
                        "><i class="fas fa-key"></i></button>
                        <button onclick="editShippingCompany('${company.id}')" title="ØªØ¹Ø¯ÙŠÙ„" style="
                            background: #3b82f6;
                            color: white;
                            border: none;
                            width: 32px;
                            height: 32px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 0.85rem;
                        "><i class="fas fa-edit"></i></button>
                        <button onclick="deleteShippingCompany('${company.id}')" title="Ø­Ø°Ù" style="
                            background: #ef4444;
                            color: white;
                            border: none;
                            width: 32px;
                            height: 32px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 0.85rem;
                        "><i class="fas fa-trash"></i></button>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.85rem; color: #666; margin-bottom: 12px;">
                    <div><i class="fas fa-tag" style="width: 18px; color: #10b981;"></i> ${company.code || '-'}</div>
                    <div><i class="fas fa-money-bill" style="width: 18px; color: #10b981;"></i> ${company.basePrice || 0} Ø±.Ø¹</div>
                    <div><i class="fas fa-phone" style="width: 18px; color: #10b981;"></i> ${company.phone || '-'}</div>
                    <div><i class="fas fa-envelope" style="width: 18px; color: #10b981;"></i> ${company.email || '-'}</div>
                </div>
                
                <!-- API Key Ù…Ø®ØªØµØ± -->
                <div style="background: #f0fdf4; border: 1px solid #10b981; border-radius: 8px; padding: 10px; margin-bottom: 10px;">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-key" style="color: #10b981;"></i>
                            <code style="font-size: 0.8rem; color: #333;">${company.apiKey ? company.apiKey.substring(0, 15) + '...' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</code>
                        </div>
                        <button onclick="copyCompanyApiKey('${company.apiKey}')" style="
                            background: #10b981;
                            color: white;
                            border: none;
                            padding: 5px 10px;
                            border-radius: 6px;
                            font-size: 0.75rem;
                            cursor: pointer;
                        "><i class="fas fa-copy"></i></button>
                    </div>
                </div>
                
                ${company.coverageAreas ? `
                    <div style="margin-top: 8px;">
                        <small style="color: #999;">Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªØºØ·ÙŠØ©:</small>
                        <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-top: 5px;">
                            ${company.coverageAreas.split(',').slice(0, 3).map(area => `
                                <span style="
                                    background: #e0f2fe;
                                    color: #0369a1;
                                    padding: 2px 8px;
                                    border-radius: 10px;
                                    font-size: 0.7rem;
                                ">${area.trim()}</span>
                            `).join('')}
                            ${company.coverageAreas.split(',').length > 3 ? `
                                <span style="color: #999; font-size: 0.7rem;">+${company.coverageAreas.split(',').length - 3}</span>
                            ` : ''}
                        </div>
                    </div>
                ` : ''}
            </div>
        `).join('');
    }
    
    // Ù†Ø³Ø® API Key Ù…Ù† Ø§Ù„ÙƒØ§Ø±Øª
    function copyCompanyApiKey(apiKey) {
        if (!apiKey) {
            showToast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ API', 'error');
            return;
        }
        navigator.clipboard.writeText(apiKey).then(() => {
            showToast('ØªÙ… Ù†Ø³Ø® Ù…ÙØªØ§Ø­ API! ğŸ“‹', 'success');
        }).catch(() => {
            // Fallback
            const temp = document.createElement('input');
            temp.value = apiKey;
            document.body.appendChild(temp);
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
            showToast('ØªÙ… Ù†Ø³Ø® Ù…ÙØªØ§Ø­ API! ğŸ“‹', 'success');
        });
    }
    
    // Ø¹Ø±Ø¶ API Key ÙƒØ§Ù…Ù„
    function viewApiKey(companyId) {
        const company = shippingCompanies.find(c => c.id === companyId);
        if (!company) return;
        
        const apiKeyDisplay = company.apiKey || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­';
        alert(`ğŸ”‘ API Key Ù„Ø´Ø±ÙƒØ© ${company.name}:\n\n${apiKeyDisplay}\n\nØ§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ Ù„Ù„Ø±Ø¨Ø· Ù…Ø¹ ØµÙØ­Ø© Ø§Ù„Ø´Ø±ÙƒØ©`);
    }
    
    // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø´Ø±ÙƒØ© Ø´Ø­Ù†
    function openShippingModal(editId = null) {
        editingShippingId = editId;
        const modal = document.getElementById('shipping-modal-overlay');
        const title = document.getElementById('shipping-modal-title');
        const form = document.getElementById('shipping-form');
        const apiSection = document.getElementById('generated-api-section');
        
        form.reset();
        
        if (editId) {
            const company = shippingCompanies.find(c => c.id === editId);
            if (company) {
                title.textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø´Ø±ÙƒØ© Ø´Ø­Ù†';
                document.getElementById('s-company-name').value = company.name || '';
                document.getElementById('s-company-code').value = company.code || '';
                document.getElementById('s-base-price').value = company.basePrice || '';
                document.getElementById('s-price-per-kg').value = company.pricePerKg || '';
                document.getElementById('s-coverage-areas').value = company.coverageAreas || '';
                document.getElementById('s-phone').value = company.phone || '';
                document.getElementById('s-email').value = company.email || '';
                document.getElementById('s-logo').value = company.logo || '';
                document.getElementById('s-status').value = company.status || 'active';
                document.getElementById('s-notes').value = company.notes || '';
                
                // Ø¹Ø±Ø¶ API Key Ø§Ù„Ø­Ø§Ù„ÙŠ
                currentGeneratedApiKey = company.apiKey;
                document.getElementById('s-generated-api-key').value = company.apiKey || '';
                apiSection.style.display = 'block';
            }
        } else {
            title.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø´Ø­Ù† Ø¬Ø¯ÙŠØ¯Ø©';
            document.getElementById('s-status').value = 'active';
            
            // ØªÙˆÙ„ÙŠØ¯ API Key Ø¬Ø¯ÙŠØ¯
            currentGeneratedApiKey = generateApiKey();
            document.getElementById('s-generated-api-key').value = currentGeneratedApiKey;
            apiSection.style.display = 'block';
        }
        
        modal.style.display = 'flex';
    }
    
    // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø­Ù†
    function closeShippingModal() {
        document.getElementById('shipping-modal-overlay').style.display = 'none';
        editingShippingId = null;
        currentGeneratedApiKey = null;
    }
    
    // Ø­ÙØ¸ Ø´Ø±ÙƒØ© Ø§Ù„Ø´Ø­Ù†
    async function saveShippingCompany() {
        const name = document.getElementById('s-company-name').value.trim();
        const code = document.getElementById('s-company-code').value.trim().toUpperCase();
        
        if (!name) {
            showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©', 'error');
            return;
        }
        
        const companyData = {
            name,
            code: code || name.substring(0, 4).toUpperCase(),
            apiKey: currentGeneratedApiKey || generateApiKey(),
            basePrice: parseFloat(document.getElementById('s-base-price').value) || 0,
            pricePerKg: parseFloat(document.getElementById('s-price-per-kg').value) || 0,
            coverageAreas: document.getElementById('s-coverage-areas').value.trim(),
            phone: document.getElementById('s-phone').value.trim(),
            email: document.getElementById('s-email').value.trim(),
            logo: document.getElementById('s-logo').value.trim(),
            status: document.getElementById('s-status').value,
            notes: document.getElementById('s-notes').value.trim(),
            updatedAt: new Date().toISOString()
        };
        
        try {
            if (editingShippingId) {
                // ØªØ¹Ø¯ÙŠÙ„ Ø´Ø±ÙƒØ© Ù…ÙˆØ¬ÙˆØ¯Ø©
                await database.ref(`restaurant-system/shippingCompanies/${editingShippingId}`).update(companyData);
                showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙƒØ© Ø§Ù„Ø´Ø­Ù† Ø¨Ù†Ø¬Ø§Ø­ âœ…', 'success');
            } else {
                // Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©
                companyData.createdAt = new Date().toISOString();
                await database.ref('restaurant-system/shippingCompanies').push(companyData);
                showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø§Ù„Ø´Ø­Ù† Ø¨Ù†Ø¬Ø§Ø­ âœ…', 'success');
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù…Ø¹ API Key
                setTimeout(() => {
                    alert(`ğŸ‰ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© "${name}" Ø¨Ù†Ø¬Ø§Ø­!\n\nğŸ”‘ API Key:\n${companyData.apiKey}\n\nâš ï¸ Ø§Ø­ÙØ¸ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙØªØ§Ø­! Ø³ØªØ­ØªØ§Ø¬Ù‡ Ù„Ù„Ø±Ø¨Ø· Ù…Ø¹ ØµÙØ­Ø© Ø§Ù„Ø´Ø±ÙƒØ©`);
                }, 300);
            }
            
            closeShippingModal();
            loadShippingCompanies();
            
        } catch (error) {
            console.error('Error saving shipping company:', error);
            showToast('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø´Ø±ÙƒØ© Ø§Ù„Ø´Ø­Ù†', 'error');
        }
    }
    
    // Ø­Ø°Ù Ø´Ø±ÙƒØ© Ø´Ø­Ù†
    async function deleteShippingCompany(companyId) {
        const company = shippingCompanies.find(c => c.id === companyId);
        if (!company) return;
        
        if (!confirm(`âš ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø´Ø±ÙƒØ© "${company.name}"?\n\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…ÙØªØ§Ø­ API!`)) return;
        
        try {
            await database.ref(`restaurant-system/shippingCompanies/${companyId}`).remove();
            showToast('ØªÙ… Ø­Ø°Ù Ø´Ø±ÙƒØ© Ø§Ù„Ø´Ø­Ù† âœ…', 'success');
            loadShippingCompanies();
        } catch (error) {
            console.error('Error deleting shipping company:', error);
            showToast('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø´Ø±ÙƒØ© Ø§Ù„Ø´Ø­Ù†', 'error');
        }
    }
    
    // ØªØ¹Ø¯ÙŠÙ„ Ø´Ø±ÙƒØ© Ø´Ø­Ù†
    function editShippingCompany(companyId) {
        openShippingModal(companyId);
    }

    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
    document.addEventListener('click', function(e) {
        const sidebar = document.getElementById('sidebar');
        const menuBtn = document.querySelector('.mobile-menu-btn');
        
        if (window.innerWidth <= 900 && 
            !sidebar.contains(e.target) && 
            !menuBtn.contains(e.target) && 
            sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
        }
    });

    // ========== Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Firebase ==========
    let projects = [];

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ù† Firebase
    async function loadProjects() {
        try {
            const grid = document.getElementById('projects-grid');
            if (!grid) {
                console.error('Ø¹Ù†ØµØ± projects-grid ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                return;
            }

            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            grid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--text-secondary);">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 20px;"></i>
                    <p style="font-size: 1rem;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹...</p>
                </div>
            `;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ firebase
            if (typeof firebase === 'undefined') {
                throw new Error('Ù…ÙƒØªØ¨Ø© Firebase ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
            }

            if (!firebase.database) {
                throw new Error('ÙˆØ­Ø¯Ø© Firebase Database ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„Ø©');
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Firebase ØªÙ… ØªÙ‡ÙŠØ¦ØªÙ‡
            let database;
            try {
                database = firebase.database();
            } catch (e) {
                throw new Error('Firebase Ù„Ù… ÙŠØªÙ… ØªÙ‡ÙŠØ¦ØªÙ‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­. Ø­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø© (Ctrl+F5)');
            }

            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const snapshot = await database.ref('restaurant-system/projects').once('value');
            
            const data = snapshot.val();
            
            if (!data || typeof data !== 'object') {
                projects = [];
            } else {
                projects = Object.keys(data).map(key => ({ 
                    id: key, 
                    ...data[key] 
                }));
            }
            
            renderProjects();
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹:', error);
            const grid = document.getElementById('projects-grid');
            if (grid) {
                const errorMsg = error.message || error.toString() || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹';
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--danger);">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 20px;"></i>
                        <p style="font-size: 1rem; margin-bottom: 10px; font-weight: 600;">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</p>
                        <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 20px; background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: 8px; border: 1px solid rgba(239, 68, 68, 0.3);">
                            ${errorMsg}
                        </p>
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                            <button onclick="loadProjects()" style="padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                            </button>
                            <button onclick="location.reload()" style="padding: 10px 20px; background: var(--secondary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©
                            </button>
                        </div>
                    </div>
                `;
            }
            showToast('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹: ' + (error.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
        }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
    function renderProjects() {
        const grid = document.getElementById('projects-grid');
        if (!grid) return;

        if (projects.length === 0) {
            grid.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--text-secondary);">
                    <i class="fas fa-project-diagram" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                    <p style="font-size: 1.1rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    <p style="font-size: 0.9rem; margin-top: 10px;">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯" Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¥Ø¶Ø§ÙØ©</p>
                </div>
            `;
            return;
        }

        grid.innerHTML = projects.map(project => {
            const isActive = project.status === 'active';
            const statusClass = isActive ? 'badge-success' : 'badge-danger';
            const statusText = isActive ? 'Ù†Ø´Ø·' : 'ØºÙŠØ± Ù†Ø´Ø·';
            
            return `
                <div class="hosting-card">
                    <div class="hosting-card-header">
                        <div class="hosting-icon" style="background: linear-gradient(135deg, #6366f1, #8b5cf6);">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <div class="hosting-info">
                            <h4>${project.displayName || project.id}</h4>
                            <p style="font-family: monospace; font-size: 0.85rem; color: var(--text-secondary);">${project.id}</p>
                        </div>
                        <span class="hosting-status ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div style="padding: 15px; background: var(--bg); border-radius: 12px; margin: 15px 0;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.85rem;">
                            <div>
                                <strong style="color: var(--text-secondary);">Database:</strong>
                                <div style="margin-top: 5px; word-break: break-all; font-family: monospace; font-size: 0.75rem;">${project.databaseURL || '-'}</div>
                            </div>
                            <div>
                                <strong style="color: var(--text-secondary);">Auth Domain:</strong>
                                <div style="margin-top: 5px; word-break: break-all; font-family: monospace; font-size: 0.75rem;">${project.authDomain || '-'}</div>
                            </div>
                        </div>
                        ${project.notes ? `<div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); color: var(--text-secondary); font-size: 0.85rem;">${project.notes}</div>` : ''}
                    </div>
                    
                    <div class="hosting-actions">
                        <button class="visit-btn" onclick="switchToProject('${project.id}')">
                            <i class="fas fa-exchange-alt"></i>
                            Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
                        </button>
                        <button class="deploy-btn" onclick="editProject('${project.id}')">
                            <i class="fas fa-edit"></i>
                            ØªØ¹Ø¯ÙŠÙ„
                        </button>
                        <button class="delete-btn" onclick="deleteProject('${project.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
        }).join('');
    }

    // ÙØªØ­ Modal Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    function openProjectModal(projectId = null) {
        const modal = document.getElementById('project-modal-overlay');
        const title = document.getElementById('project-modal-title');
        
        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        document.getElementById('project-form').reset();
        document.getElementById('project-edit-id').value = '';
        
        if (projectId) {
            const project = projects.find(p => p.id === projectId);
            if (project) {
                title.innerHTML = '<i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„ Ù…Ø´Ø±ÙˆØ¹ Firebase';
                document.getElementById('project-edit-id').value = projectId;
                document.getElementById('project-id').value = project.id;
                document.getElementById('project-display-name').value = project.displayName || '';
                document.getElementById('project-api-key').value = project.apiKey || '';
                document.getElementById('project-database-url').value = project.databaseURL || '';
                document.getElementById('project-auth-domain').value = project.authDomain || '';
                document.getElementById('project-storage-bucket').value = project.storageBucket || '';
                document.getElementById('project-messaging-sender-id').value = project.messagingSenderId || '';
                document.getElementById('project-app-id').value = project.appId || '';
                document.getElementById('project-status').value = project.status || 'active';
                document.getElementById('project-notes').value = project.notes || '';
                
                // ØªØ¹Ø·ÙŠÙ„ ØªØ¹Ø¯ÙŠÙ„ Project ID
                document.getElementById('project-id').disabled = true;
            }
        } else {
            title.innerHTML = '<i class="fas fa-project-diagram"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Firebase Ø¬Ø¯ÙŠØ¯';
            document.getElementById('project-id').disabled = false;
        }
        
        modal.classList.add('active');
    }

    // Ø¥ØºÙ„Ø§Ù‚ Modal Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    function closeProjectModal() {
        document.getElementById('project-modal-overlay').classList.remove('active');
    }

    // Ø­ÙØ¸ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    async function saveProject() {
        const editId = document.getElementById('project-edit-id').value;
        const projectId = document.getElementById('project-id').value.trim();
        
        if (!projectId) {
            showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Project ID', 'error');
            return;
        }

        const projectData = {
            displayName: document.getElementById('project-display-name').value.trim(),
            apiKey: document.getElementById('project-api-key').value.trim(),
            databaseURL: document.getElementById('project-database-url').value.trim(),
            authDomain: document.getElementById('project-auth-domain').value.trim(),
            storageBucket: document.getElementById('project-storage-bucket').value.trim() || null,
            messagingSenderId: document.getElementById('project-messaging-sender-id').value.trim() || null,
            appId: document.getElementById('project-app-id').value.trim() || null,
            status: document.getElementById('project-status').value,
            notes: document.getElementById('project-notes').value.trim() || '',
            updatedAt: new Date().toISOString()
        };

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
        if (!projectData.apiKey || !projectData.databaseURL || !projectData.authDomain) {
            showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (API Key, Database URL, Auth Domain)', 'error');
            return;
        }

        if (!editId) {
            // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯
            projectData.createdAt = new Date().toISOString();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„ØªÙƒØ±Ø§Ø±
            if (projects.some(p => p.id === projectId)) {
                showToast('Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'error');
                return;
            }
        }

        try {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Firebase
            if (typeof firebase === 'undefined' || !firebase.database) {
                throw new Error('Firebase ØºÙŠØ± Ù…ØªØ§Ø­');
            }

            const database = firebase.database();
            await database.ref(`restaurant-system/projects/${projectId}`).set(projectData);
            
            await loadProjects();
            closeProjectModal();
            showToast(editId ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø´Ø±ÙˆØ¹' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:', error);
            showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ' + (error.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
        }
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    function editProject(projectId) {
        openProjectModal(projectId);
    }

    // Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    async function deleteProject(projectId) {
        if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ "${projectId}"ØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙ‚Ø·.`)) {
            return;
        }

        try {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Firebase
            if (typeof firebase === 'undefined' || !firebase.database) {
                throw new Error('Firebase ØºÙŠØ± Ù…ØªØ§Ø­');
            }

            const database = firebase.database();
            await database.ref(`restaurant-system/projects/${projectId}`).remove();
            await loadProjects();
            showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:', error);
            showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ' + (error.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
        }
    }

    // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ù…Ø´Ø±ÙˆØ¹ Ù…Ø¹ÙŠÙ†
    function switchToProject(projectId) {
        const project = projects.find(p => p.id === projectId);
        if (!project) {
            showToast('Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            return;
        }

        if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ "${project.displayName || projectId}"ØŸ\n\nØ³ÙŠØªÙ… Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…Ø­Ù„ÙŠØ§Ù‹.`)) {
            return;
        }

        // Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ localStorage
        localStorage.setItem('currentFirebaseProject', JSON.stringify({
            id: project.id,
            displayName: project.displayName,
            apiKey: project.apiKey,
            databaseURL: project.databaseURL,
            authDomain: project.authDomain,
            storageBucket: project.storageBucket,
            messagingSenderId: project.messagingSenderId,
            appId: project.appId
        }));

        showToast(`ØªÙ… Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ "${project.displayName || projectId}"\nÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© (Ctrl+F5) Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª`, 'success');
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
        setTimeout(() => {
            window.location.reload();
        }, 2000);
    }
    </script>
</body>
</html>
